parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"mhoU":[function(require,module,exports) {
var global = arguments[3];
var define;
var e,t=arguments[3];function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){if(!e)throw"MediaStream is mandatory.";var t;this.start=function(i){var a;"undefined"!=typeof MediaRecorder?a=h:(M||A||y)&&(-1!==this.mimeType.indexOf("video")?a=m:-1!==this.mimeType.indexOf("audio")&&(a=f)),"image/gif"===this.mimeType&&(a=g),"audio/wav"!==this.mimeType&&"audio/pcm"!==this.mimeType||(a=f),this.recorderType&&(a=this.recorderType),(t=new a(e)).blobs=[];var o=this;t.ondataavailable=function(e){t.blobs.push(e),o.ondataavailable(e)},t.onstop=this.onstop,t.onStartedDrawingNonBlankFrames=this.onStartedDrawingNonBlankFrames,(t=r(t,this)).start(i)},this.onStartedDrawingNonBlankFrames=function(){},this.clearOldRecordedFrames=function(){t&&t.clearOldRecordedFrames()},this.stop=function(){t&&t.stop()},this.ondataavailable=function(e){this.disableLogs||console.log("ondataavailable..",e)},this.onstop=function(e){console.warn("stopped..",e)},this.save=function(e,i){if(e)d(e,i);else{if(!t)return;ConcatenateBlobs(t.blobs,t.blobs[0].type,function(e){d(e)})}},this.pause=function(){t&&(t.pause(),this.disableLogs||console.log("Paused recording.",this.mimeType||t.mimeType))},this.resume=function(){t&&(t.resume(),this.disableLogs||console.log("Resumed recording.",this.mimeType||t.mimeType))},this.recorderType=null,this.mimeType="video/webm",this.disableLogs=!1}function o(e,t){(e=e||[])instanceof T&&(e=[e]);var i,o,r=this;(t=t||{mimeType:"video/webm",video:{width:360,height:240}}).frameInterval||(t.frameInterval=10),t.video||(t.video={}),t.video.width||(t.video.width=360),t.video.height||(t.video.height=240),this.start=function(s){var d;for(var u in i=new n(e),(d=[],e.forEach(function(e){e.getVideoTracks().forEach(function(e){d.push(e)})}),d).length&&(i.frameInterval=t.frameInterval||10,i.width=t.video.width||360,i.height=t.video.height||240,i.startDrawingFrames()),"function"==typeof r.previewStream&&r.previewStream(i.getMixedStream()),o=new a(i.getMixedStream()),r)"function"!=typeof r[u]&&(o[u]=r[u]);o.ondataavailable=function(e){r.ondataavailable(e)},o.onstop=r.onstop,o.start(s)},this.stop=function(e){o&&o.stop(function(t){e(t)})},this.pause=function(){o&&o.pause()},this.resume=function(){o&&o.resume()},this.clearRecordedData=function(){o&&(o.clearRecordedData(),o=null),i&&(i.releaseStreams(),i=null)},this.addStreams=this.addStream=function(t){if(!t)throw"First parameter is required.";t instanceof Array||(t=[t]),e.concat(t),o&&i&&i.appendStreams(t)},this.resetVideoStreams=function(e){i&&(!e||e instanceof Array||(e=[e]),i.resetVideoStreams(e))},this.ondataavailable=function(e){r.disableLogs||console.log("ondataavailable",e)},this.onstop=function(){},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}function n(e){function t(){if(!r){var e=n.length,a=!1,o=[];n.forEach(function(e){e.stream||(e.stream={}),e.stream.fullcanvas?a=e:o.push(e)}),a?(s.width=a.stream.width,s.height=a.stream.height):o.length?(s.width=e>1?2*o[0].width:o[0].width,s.height=e>2?2*o[0].height:o[0].height):(s.width=u.width||360,s.height=u.height||240),a&&a instanceof HTMLVideoElement&&i(a),o.forEach(function(e,t){i(e,t)}),setTimeout(t,u.frameInterval)}}function i(e,t){if(!r){var i=0,a=0,o=e.width,n=e.height;1===t&&(i=e.width),2===t&&(a=e.height),3===t&&(i=e.width,a=e.height),void 0!==e.stream.left&&(i=e.stream.left),void 0!==e.stream.top&&(a=e.stream.top),void 0!==e.stream.width&&(o=e.stream.width),void 0!==e.stream.height&&(n=e.stream.height),d.drawImage(e,i,a,o,n),"function"==typeof e.stream.onRender&&e.stream.onRender(d,i,a,o,n,t)}}function a(e){var t=document.createElement("video");return"srcObject"in t?t.srcObject=e:t.src=h.createObjectURL(e),t.muted=!0,t.volume=0,t.width=e.width||u.width||360,t.height=e.height||u.height||240,t.play(),t}function o(t){n=[],(t=t||e).forEach(function(e){if(e.getVideoTracks().length){var t=a(e);t.stream=e,n.push(t)}})}var n=[],r=!1,s=document.createElement("canvas"),d=s.getContext("2d");s.style="opacity:0;position:absolute;z-index:-1;top: -100000000;left:-1000000000; margin-top:-1000000000;margin-left:-1000000000;",(document.body||document.documentElement).appendChild(s),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var u=this,c=window.AudioContext;void 0===c&&("undefined"!=typeof webkitAudioContext&&(c=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(c=mozAudioContext));var h=window.URL;void 0===h&&"undefined"!=typeof webkitURL&&(h=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var f=window.MediaStream;void 0===f&&"undefined"!=typeof webkitMediaStream&&(f=webkitMediaStream),void 0!==f&&("getVideoTracks"in f.prototype||(f.prototype.getVideoTracks=function(){if(!this.getTracks)return[];var e=[];return this.getTracks.forEach(function(t){-1!==t.kind.toString().indexOf("video")&&e.push(t)}),e},f.prototype.getAudioTracks=function(){if(!this.getTracks)return[];var e=[];return this.getTracks.forEach(function(t){-1!==t.kind.toString().indexOf("audio")&&e.push(t)}),e}),void 0===f.prototype.stop&&(f.prototype.stop=function(){this.getTracks().forEach(function(e){e.stop()})}));var l={};void 0!==c?l.AudioContext=c:"undefined"!=typeof webkitAudioContext&&(l.AudioContext=webkitAudioContext),this.startDrawingFrames=function(){t()},this.appendStreams=function(t){if(!t)throw"First parameter is required.";t instanceof Array||(t=[t]),e.concat(t),t.forEach(function(e){if(e.getVideoTracks().length){var t=a(e);t.stream=e,n.push(t)}if(e.getAudioTracks().length&&u.audioContext){var i=u.audioContext.createMediaStreamSource(e);i.connect(u.audioDestination),u.audioSources.push(i)}})},this.releaseStreams=function(){n=[],r=!0,u.gainNode&&(u.gainNode.disconnect(),u.gainNode=null),u.audioSources.length&&(u.audioSources.forEach(function(e){e.disconnect()}),u.audioSources=[]),u.audioDestination&&(u.audioDestination.disconnect(),u.audioDestination=null),u.audioContext=null,d.clearRect(0,0,s.width,s.height),s.stream&&(s.stream.stop(),s.stream=null)},this.resetVideoStreams=function(e){!e||e instanceof Array||(e=[e]),o(e)},this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=function(){r=!1;var t=function(){var e;o(),"captureStream"in s?e=s.captureStream():"mozCaptureStream"in s?e=s.mozCaptureStream():u.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var t=new f;return e.getVideoTracks().forEach(function(e){t.addTrack(e)}),s.stream=t,t}(),i=function(){l.AudioContextConstructor||(l.AudioContextConstructor=new l.AudioContext),u.audioContext=l.AudioContextConstructor,u.audioSources=[],!0===u.useGainNode&&(u.gainNode=u.audioContext.createGain(),u.gainNode.connect(u.audioContext.destination),u.gainNode.gain.value=0);var t=0;if(e.forEach(function(e){if(e.getAudioTracks().length){t++;var i=u.audioContext.createMediaStreamSource(e);!0===u.useGainNode&&i.connect(u.gainNode),u.audioSources.push(i)}}),t)return u.audioDestination=u.audioContext.createMediaStreamDestination(),u.audioSources.forEach(function(e){e.connect(u.audioDestination)}),u.audioDestination.stream}();return i&&i.getAudioTracks().forEach(function(e){t.addTrack(e)}),e.forEach(function(e){e.fullcanvas}),t}}function r(e,t){for(var i in t)"function"!=typeof t[i]&&(e[i]=t[i]);return e}function s(e){return e.shift(),e}function d(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(s){}var i=(e.type||"video/webm").split("/")[1];if(t&&-1!==t.indexOf(".")){var a=t.split(".");t=a[0],i=a[1]}var o=(t||Math.round(9999999999*Math.random())+888888888)+"."+i;if(void 0!==navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,o);if(void 0!==navigator.msSaveBlob)return navigator.msSaveBlob(e,o);var n=document.createElement("a");n.href=b.createObjectURL(e),n.target="_blank",n.download=o,navigator.mozGetUserMedia&&(n.onclick=function(){(document.body||document.documentElement).removeChild(n)},(document.body||document.documentElement).appendChild(n));var r=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});n.dispatchEvent(r),navigator.mozGetUserMedia||b.revokeObjectURL(n.href)}function u(e){if(0===e)return"0 Bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return(e/Math.pow(1e3,t)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][t]}function c(){var e=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t=!!window.chrome&&!e;if(void 0!==window.InstallTrigger)return!0;if(!t)return!1;var i,a,o=(navigator.appVersion,navigator.userAgent),n=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10);return t&&(i=o.indexOf("Chrome"),n=o.substring(i+7)),-1!==(a=n.indexOf(";"))&&(n=n.substring(0,a)),-1!==(a=n.indexOf(" "))&&(n=n.substring(0,a)),r=parseInt(""+n,10),isNaN(r)&&(n=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10)),r>=49}function h(e){var t,i=this;this.start=function(a,o){var n;(this.timeSlice=a||5e3,i.mimeType||(i.mimeType="video/webm"),-1!==i.mimeType.indexOf("audio")&&e.getVideoTracks().length&&e.getAudioTracks().length)&&(navigator.mozGetUserMedia?(n=new T).addTrack(e.getAudioTracks()[0]):n=new T(e.getAudioTracks()),e=n);-1!==i.mimeType.indexOf("audio")&&(i.mimeType=M?"audio/webm":"audio/ogg"),i.dontFireOnDataAvailableEvent=!1;var r={mimeType:i.mimeType};i.disableLogs||o||console.log("Passing following params over MediaRecorder API.",r),t&&(t=null),M&&!c()&&(r="video/vp8");try{t=new MediaRecorder(e,r)}catch(d){t=new MediaRecorder(e)}"canRecordMimeType"in t&&!1===t.canRecordMimeType(i.mimeType)&&(i.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",i.mimeType)),!0===i.ignoreMutedMedia&&(t.ignoreMutedMedia=!0);var s=!1;t.ondataavailable=function(e){if(e.data&&e.data.size&&!(e.data.size<26800)&&!s){s=!0;var o=i.getNativeBlob?e.data:new Blob([e.data],{type:i.mimeType||"video/webm"});i.ondataavailable(o),t&&"recording"===t.state&&t.stop(),t=null,i.dontFireOnDataAvailableEvent||i.start(a,"__disableLogs")}},t.onerror=function(e){i.disableLogs||("InvalidState"===e.name?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed."):"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute."):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute."):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute."):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e)),t&&"inactive"!==t.state&&"stopped"!==t.state&&t.stop()};try{t.start(36e5)}catch(d){t=null}setTimeout(function(){t&&"recording"===t.state&&t.requestData()},a)},this.stop=function(e){t&&"recording"===t.state&&(t.requestData(),setTimeout(function(){i.dontFireOnDataAvailableEvent=!0,t&&"recording"===t.state&&t.stop(),t=null,i.onstop()},2e3))},this.pause=function(){t&&("recording"===t.state&&t.pause(),this.dontFireOnDataAvailableEvent=!0)},this.ondataavailable=function(e){console.log("recorded-blob",e)},this.resume=function(){if(this.dontFireOnDataAvailableEvent){this.dontFireOnDataAvailableEvent=!1;var e=i.disableLogs;return i.disableLogs=!0,this.start(this.timeslice||5e3),void(i.disableLogs=e)}t&&"paused"===t.state&&t.resume()},this.clearRecordedData=function(){t&&(this.pause(),this.dontFireOnDataAvailableEvent=!0,this.stop())},this.onstop=function(){},function a(){if(t)return!1===function(){if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}()?void i.stop():void setTimeout(a,1e3)}()}function f(e){var t,i;this.start=function(a){a=a||1e3,(t=new l(e,this)).record(),i=setInterval(function(){t.requestData()},a)},this.stop=function(){t&&(t.stop(),clearTimeout(i),this.onstop())},this.pause=function(){t&&t.pause()},this.resume=function(){t&&t.resume()},this.ondataavailable=function(){},this.onstop=function(){}}function l(e,t){function i(e,t){for(var i=new Float32Array(t),a=0,o=e.length,n=0;n<o;n++){var r=e[n];i.set(r,a),a+=r.length}return i}function a(e,t,i){for(var a=i.length,o=0;o<a;o++)e.setUint8(t+o,i.charCodeAt(o))}function o(e){for(var t=e.length,i=new Int16Array(t);t--;)i[t]=65535*e[t];return i.buffer}var n;S.AudioContextConstructor||(S.AudioContextConstructor=new S.AudioContext),n=S.AudioContextConstructor.sampleRate;var r,s=[],d=[],c=!1,h=0,f=t.sampleRate||n,l=(t.mimeType||"audio/wav").indexOf("audio/pcm")>-1,m=t.audioChannels||2;this.record=function(){c=!0,s.length=d.length=0,h=0},this.requestData=function(){if(!y){if(0===h)return void(b=!1);b=!0;var e=s.slice(0),n=d.slice(0),r=h;s.length=d.length=[],h=0,b=!1;var c=i(e,r),p=c;if(2===m)p=function(e,t){for(var i=e.length+t.length,a=new Float32Array(i),o=0,n=0;n<i;)a[n++]=e[o],a[n++]=t[o],o++;return a}(c,i(n,r));if(l){var g=new Blob([o(p)],{type:"audio/pcm"});return console.debug("audio recorded blob size:",u(g.size)),void t.ondataavailable(g)}var v=new ArrayBuffer(44+2*p.length),w=new DataView(v);a(w,0,"RIFF"),w.setUint32(4,44+2*p.length-8,!0),a(w,8,"WAVE"),a(w,12,"fmt "),w.setUint32(16,16,!0),w.setUint16(20,1,!0),w.setUint16(22,m,!0),w.setUint32(24,f,!0),w.setUint32(28,f*m*2,!0),w.setUint16(32,2*m,!0),w.setUint16(34,16,!0),a(w,36,"data"),w.setUint32(40,2*p.length,!0);for(var A=p.length,M=44,T=0;T<A;T++)w.setInt16(M,32767*p[T],!0),M+=2;g=new Blob([w],{type:"audio/wav"});console.debug("audio recorded blob size:",u(g.size)),t.ondataavailable(g)}},this.stop=function(){c=!1,this.requestData(),g.disconnect(),this.onstop()};var p=S.AudioContextConstructor;S.VolumeGainNode=p.createGain();var g,v=S.VolumeGainNode;S.AudioInput=p.createMediaStreamSource(e),(g=S.AudioInput).connect(v);var w=t.bufferSize||2048;if(0===t.bufferSize&&(w=0),p.createJavaScriptNode)r=p.createJavaScriptNode(w,m,m);else{if(!p.createScriptProcessor)throw"WebAudio API has no support on this browser.";r=p.createScriptProcessor(w,m,m)}w=r.bufferSize,console.debug("using audio buffer-size:",w);var b=!1;window.scriptprocessornode=r,1===m&&console.debug("All right-channels are skipped.");var y=!1;this.pause=function(){y=!0},this.resume=function(){y=!1},this.onstop=function(){},r.onaudioprocess=function(e){if(c&&!b&&!y){var t=e.inputBuffer.getChannelData(0);if(s.push(new Float32Array(t)),2===m){var i=e.inputBuffer.getChannelData(1);d.push(new Float32Array(i))}h+=w}},v.connect(r),r.connect(p.destination)}function m(e){var t,i;this.start=function(a){for(var o in a=a||1e3,t=new p(e,this),this)"function"!=typeof this[o]&&(t[o]=this[o]);t.record(),i=setInterval(function(){t.requestData()},a)},this.stop=function(){t&&(t.stop(),clearTimeout(i),this.onstop())},this.onstop=function(){},this.clearOldRecordedFrames=function(){t&&t.clearOldRecordedFrames()},this.pause=function(){t&&t.pause()},this.resume=function(){t&&t.resume()},this.ondataavailable=function(){}}function p(e,t){function i(){if(l)return s=(new Date).getTime(),void setTimeout(i,500);if(!n){if(a)return setTimeout(i,100);var e=(new Date).getTime()-s;if(!e)return i();s=(new Date).getTime(),!f.isHTMLObject&&r.paused&&r.play(),h.drawImage(r,0,0,c.width,c.height),n||d.frames.push({duration:e,image:c.toDataURL("image/webp")}),o||function(e,t,i){var a=document.createElement("canvas");a.width=c.width,a.height=c.height;var o,n,r,s=a.getContext("2d"),d={r:0,g:0,b:0},u=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),h=t&&t>=0&&t<=1?t:0,f=i&&i>=0&&i<=1?i:0,l=new Image;l.src=e.image,s.drawImage(l,0,0,c.width,c.height);var m=s.getImageData(0,0,c.width,c.height);o=0,n=m.data.length,r=m.data.length/4;for(var p=0;p<n;p+=4){var g={r:m.data[p],g:m.data[p+1],b:m.data[p+2]},v=Math.sqrt(Math.pow(g.r-d.r,2)+Math.pow(g.g-d.g,2)+Math.pow(g.b-d.b,2));v<=u*h&&o++}return!(r-o<=r*f)}(d.frames[d.frames.length-1])||(o=!0,t.onStartedDrawingNonBlankFrames()),setTimeout(i,10)}}this.record=function(a){this.width||(this.width=320),this.height||(this.height=240),this.video&&this.video instanceof HTMLVideoElement&&(this.width||(this.width=r.videoWidth||r.clientWidth||320),this.height||(this.height=r.videoHeight||r.clientHeight||240)),this.video||(this.video={width:this.width,height:this.height}),this.canvas&&this.canvas.width&&this.canvas.height||(this.canvas={width:this.width,height:this.height}),c.width=this.canvas.width,c.height=this.canvas.height,this.video&&this.video instanceof HTMLVideoElement?(this.isHTMLObject=!0,r=this.video.cloneNode()):((r=document.createElement("video")).src=b.createObjectURL(e),r.width=this.video.width,r.height=this.video.height),r.muted=!0,r.play(),s=(new Date).getTime(),d=new k.Video(t.speed,t.quality),console.log("canvas resolutions",c.width,"*",c.height),console.log("video width/height",r.width||c.width,"*",r.height||c.height),i()},this.clearOldRecordedFrames=function(){d.frames=[]};var a=!1;this.requestData=function(){if(!l){if(!d.frames.length)return void(a=!1);a=!0;var e=d.frames.slice(0);d.frames=function(e,t,i,a){var o=document.createElement("canvas");o.width=c.width,o.height=c.height;for(var n=o.getContext("2d"),r=[],s=-1===t,d=t&&t>0&&t<=e.length?t:e.length,u={r:0,g:0,b:0},h=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),f=i&&i>=0&&i<=1?i:0,l=a&&a>=0&&a<=1?a:0,m=!1,p=0;p<d;p++){var g,v,w;if(!m){var b=new Image;b.src=e[p].image,n.drawImage(b,0,0,c.width,c.height);var y=n.getImageData(0,0,c.width,c.height);g=0,v=y.data.length,w=y.data.length/4;for(var A=0;A<v;A+=4){var M={r:y.data[A],g:y.data[A+1],b:y.data[A+2]};Math.sqrt(Math.pow(M.r-u.r,2)+Math.pow(M.g-u.g,2)+Math.pow(M.b-u.b,2))<=h*f&&g++}}!m&&w-g<=w*l||(s&&(m=!0),r.push(e[p]))}return(r=r.concat(e.slice(d))).length<=0&&r.push(e[e.length-1]),r}(e,-1),d.compile(function(e){t.ondataavailable(e),console.debug("video recorded blob size:",u(e.size))}),d.frames=[],a=!1}};var o=!1,n=!1;this.stop=function(){n=!0,this.requestData(),this.onstop()};var r,s,d,c=document.createElement("canvas"),h=c.getContext("2d"),f=this,l=!1;this.pause=function(){l=!0},this.resume=function(){l=!1},this.onstop=function(){}}function g(e){function t(){Date.now();var e=new Blob([new Uint8Array(u.stream().bin)],{type:"image/gif"});o.ondataavailable(e),u.stream().bin=[]}if("undefined"==typeof GIFEncoder)throw"Please link: https://cdn.webrtc-experiment.com/gif-recorder.js";this.start=function(e){e=e||1e3;var o=this.videoWidth||320,f=this.videoHeight||240;n.width=s.width=o,n.height=s.height=f,(u=new GIFEncoder).setRepeat(0),u.setDelay(this.frameRate||this.speed||200),u.setQuality(this.quality||1),u.start(),Date.now(),h=requestAnimationFrame(function e(t){return a?void setTimeout(e,500,t):(h=requestAnimationFrame(e),void 0===i(d)&&(d=t),void(t-d<90||(s.paused&&s.play(),r.drawImage(s,0,0,o,f),u.addFrame(r),d=t)))}),c=setTimeout(t,e)},this.stop=function(){h&&(cancelAnimationFrame(h),clearTimeout(c),t(),this.onstop())},this.onstop=function(){};var a=!1;this.pause=function(){a=!0},this.resume=function(){a=!1},this.ondataavailable=function(){},this.onstop=function(){};var o=this,n=document.createElement("canvas"),r=n.getContext("2d"),s=document.createElement("video");s.muted=!0,s.autoplay=!0,s.src=b.createObjectURL(e),s.play();var d,u,c,h=null}void 0!==a&&(a.MultiStreamRecorder=o);var v,w="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";!function(e){"undefined"==typeof window&&("undefined"==typeof window&&void 0!==t&&(t.navigator={userAgent:w,getUserMedia:function(){}},e.window=t),"undefined"==typeof document&&(e.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){return{}}),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(e.screen={width:0,height:0}))}(void 0!==t?t:window),void 0===(v=window.AudioContext)&&("undefined"!=typeof webkitAudioContext&&(v=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(v=mozAudioContext)),"undefined"==typeof window&&(window={}),void 0===(v=window.AudioContext)&&("undefined"!=typeof webkitAudioContext&&(v=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(v=mozAudioContext));var b=window.URL;void 0===b&&"undefined"!=typeof webkitURL&&(b=webkitURL),"undefined"!=typeof navigator?(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia)):navigator={getUserMedia:function(){},userAgent:w};var y=!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob),A=!1;"undefined"!=typeof opera&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("OPR/")&&(A=!0);var M=!y&&!y&&!!navigator.webkitGetUserMedia,T=window.MediaStream;void 0===T&&"undefined"!=typeof webkitMediaStream&&(T=webkitMediaStream),void 0!==T&&("getVideoTracks"in T.prototype||(T.prototype.getVideoTracks=function(){if(!this.getTracks)return[];var e=[];return this.getTracks.forEach(function(t){-1!==t.kind.toString().indexOf("video")&&e.push(t)}),e},T.prototype.getAudioTracks=function(){if(!this.getTracks)return[];var e=[];return this.getTracks.forEach(function(t){-1!==t.kind.toString().indexOf("audio")&&e.push(t)}),e}),"stop"in T.prototype||(T.prototype.stop=function(){this.getAudioTracks().forEach(function(e){e.stop&&e.stop()}),this.getVideoTracks().forEach(function(e){e.stop&&e.stop()})})),"undefined"!=typeof location&&0===location.href.indexOf("file:")&&console.error("Please load this HTML file on HTTP or HTTPS.");var S={AudioContext:v};void 0!==a&&(a.MediaRecorderWrapper=h),void 0!==a&&(a.StereoAudioRecorder=f),void 0!==a&&(a.StereoAudioRecorderHelper=l),void 0!==a&&(a.WhammyRecorder=m),void 0!==a&&(a.WhammyRecorderHelper=p),void 0!==a&&(a.GifRecorder=g);var k=function(){function e(e,t){this.frames=[],e||(e=1),this.duration=1e3/e,this.quality=t||.8}function t(e){function t(e,t,i){return[{data:e,id:231}].concat(i.map(function(e){var i=function(e){var t=0;if(e.keyframe&&(t|=128),e.invisible&&(t|=8),e.lacing&&(t|=e.lacing<<1),e.discardable&&(t|=1),e.trackNum>127)throw"TrackNumber > 127 not supported";return[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map(function(e){return String.fromCharCode(e)}).join("")+e.frame}({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(t)});return t+=e.duration,{data:i,id:163}}))}function a(e){for(var t=[];e>0;)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function o(e){var t=[];e=(e.length%8?new Array(9-e.length%8).join("0"):"")+e;for(var i=0;i<e.length;i+=8)t.push(parseInt(e.substr(i,8),2));return new Uint8Array(t)}function n(e,t){return parseInt(e.substr(t+4,4).split("").map(function(e){var t=e.charCodeAt(0).toString(2);return new Array(8-t.length+1).join("0")+t}).join(""),2)}var r=new function(e){var n,r=function(e){if(e[0]){for(var t=e[0].width,i=e[0].height,a=e[0].duration,o=1;o<e.length;o++)a+=e[o].duration;return{duration:a,width:t,height:i}}postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."})}(e);if(!r)return[];for(var s=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:(n=r.duration,[].slice.call(new Uint8Array(new Float64Array([n]).buffer),0).map(function(e){return String.fromCharCode(e)}).reverse().join("")),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:r.width,id:176},{data:r.height,id:186}]}]}]}]}],d=0,u=0;d<e.length;){var c=[],h=0;do{c.push(e[d]),h+=e[d].duration,d++}while(d<e.length&&h<3e4);var f={id:524531317,data:t(u,0,c)};s[1].data.push(f),u+=h}return function e(t){for(var n=[],r=0;r<t.length;r++){var s=t[r].data;"object"==i(s)&&(s=e(s)),"number"==typeof s&&(s=o(s.toString(2))),"string"==typeof s&&(s=new Uint8Array(s.split("").map(function(e){return e.charCodeAt(0)})));var d=s.size||s.byteLength||s.length,u=Math.ceil(Math.ceil(Math.log(d)/Math.log(2))/8),c=d.toString(2),h=new Array(7*u+7+1-c.length).join("0")+c,f=new Array(u).join("0")+"1"+h;n.push(a(t[r].id)),n.push(o(f)),n.push(s)}return new Blob(n,{type:"video/webm"})}(s)}(e.map(function(e){var t=function(e){for(var t=e.RIFF[0].WEBP[0],i=t.indexOf("*"),a=0,o=[];a<4;a++)o[a]=t.charCodeAt(i+3+a);return{width:16383&(o[1]<<8|o[0]),height:16383&(o[3]<<8|o[2]),data:t,riff:e}}(function e(t){for(var i=0,a={};i<t.length;){var o=t.substr(i,4),r=n(t,i),s=t.substr(i+4+4,r);i+=8+r,a[o]=a[o]||[],"RIFF"===o||"LIST"===o?a[o].push(e(s)):a[o].push(s)}return a}(atob(e.image.slice(23))));return t.duration=e.duration,t}));postMessage(r)}return e.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},e.prototype.compile=function(e){var i,a,o,n=(i=t,a=b.createObjectURL(new Blob([i.toString(),"this.onmessage =  function (e) {"+i.name+"(e.data);}"],{type:"application/javascript"})),o=new Worker(a),b.revokeObjectURL(a),o);n.onmessage=function(t){return t.data.error?void console.error(t.data.error):void e(t.data)},n.postMessage(this.frames)},{Video:e}}();void 0!==a&&(a.Whammy=k),window.ConcatenateBlobs=function(e,t,i){var a=[],o=0;!function n(){if(!e[o])return function(){var e=0;a.forEach(function(t){e+=t.byteLength});var o=new Uint16Array(e),n=0;a.forEach(function(e){var t=e.byteLength;t%2!=0&&(e=e.slice(0,t-1)),o.set(new Uint16Array(e),n),n+=t});var r=new Blob([o.buffer],{type:t});i(r)}();var r=new FileReader;r.onload=function(e){a.push(e.target.result),o++,n()},r.readAsArrayBuffer(e[o])}()},"undefined"!=typeof module&&(module.exports=a),"function"==typeof e&&e.amd&&e("MediaStreamRecorder",[],function(){return a});
},{}],"uDgH":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"JLXO":[function(require,module,exports) {
var define;
var global = arguments[3];
var process = require("process");
var t,n=arguments[3],e=require("process");!function(e){"object"==typeof exports?module.exports=e():"function"==typeof t&&t.amd?t(e):"undefined"!=typeof window?window.when=e():void 0!==n?n.when=e():"undefined"!=typeof self&&(self.when=e())}(function(){return function t(n,e,r){function o(u,c){if(!e[u]){if(!n[u]){var f="function"==typeof require&&require;if(!c&&f)return f(u,!0);if(i)return i(u,!0);throw new Error("Cannot find module '"+u+"'")}var l=e[u]={exports:{}};n[u][0].call(l.exports,function(t){var e=n[u][1][t];return o(e||t)},l,l.exports,t,n,e,r)}return e[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(t,n,e){var r=n.exports=t("../when");r.callbacks=t("../callbacks"),r.cancelable=t("../cancelable"),r.delay=t("../delay"),r.fn=t("../function"),r.guard=t("../guard"),r.keys=t("../keys"),r.nodefn=r.node=t("../node"),r.parallel=t("../parallel"),r.pipeline=t("../pipeline"),r.poll=t("../poll"),r.sequence=t("../sequence"),r.timeout=t("../timeout")},{"../callbacks":2,"../cancelable":3,"../delay":4,"../function":5,"../guard":6,"../keys":7,"../node":26,"../parallel":27,"../pipeline":28,"../poll":29,"../sequence":30,"../timeout":31,"../when":32}],2:[function(t,n,e){!function(t){t(function(t){var n=t("./when").Promise,e=t("./lib/liftAll"),r=Array.prototype.slice,o=t("./lib/apply")(n,function(t,n,e,r){e.push(f(r.resolve,r),f(r.reject,r)),function(t,n,e,r){try{t.apply(n,e)}catch(o){r.reject(o)}}(t,n,e,r)});return{lift:i,liftAll:function(t,n,r){return e(i,n,r,t)},apply:function(t,n){return o(t,this,n||[])},call:function(t){return o(t,this,r.call(arguments,1))},promisify:function(t,e){return function(){var r=this;return n.all(arguments).then(function(o){var i,f,l=n._defer();return"number"==typeof e.callback&&(i=u(o,e.callback)),"number"==typeof e.errback&&(f=u(o,e.errback)),f<i?(c(o,f,l._handler.reject,l._handler),c(o,i,l._handler.resolve,l._handler)):(c(o,i,l._handler.resolve,l._handler),c(o,f,l._handler.reject,l._handler)),t.apply(r,o),l})}}};function i(t){var n=arguments.length>1?r.call(arguments,1):[];return function(){return o(t,this,n.concat(r.call(arguments)))}}function u(t,n){return n<0?t.length+n+2:n}function c(t,n,e,r){"number"==typeof n&&t.splice(n,0,f(e,r))}function f(t,n){return function(){arguments.length>1?t.call(n,r.call(arguments)):t.apply(n,arguments)}}})}(function(e){n.exports=e(t)})},{"./lib/apply":11,"./lib/liftAll":23,"./when":32}],3:[function(t,n,e){!function(t){t(function(){return function(t,n){return t.cancel=function(){try{t.reject(n(t))}catch(e){t.reject(e)}return t.promise},t}})}(function(t){n.exports=t()})},{}],4:[function(t,n,e){!function(t){t(function(t){var n=t("./when");return function(t,e){return n(e).delay(t)}})}(function(e){n.exports=e(t)})},{"./when":32}],5:[function(t,n,e){!function(t){t(function(t){var n=t("./when"),e=n.try,r=t("./lib/liftAll"),o=t("./lib/apply")(n.Promise),i=Array.prototype.slice;return{lift:u,liftAll:function(t,n,e){return r(u,n,e,t)},call:e,apply:function(t,n){return o(t,this,null==n?[]:i.call(n))},compose:function(t){var r=i.call(arguments,1);return function(){var o=this,u=i.call(arguments),c=e.apply(o,[t].concat(u));return n.reduce(r,function(t,n){return n.call(o,t)},c)}}};function u(t){var n=arguments.length>1?i.call(arguments,1):[];return function(){return o(t,this,n.concat(i.call(arguments)))}}})}(function(e){n.exports=e(t)})},{"./lib/apply":11,"./lib/liftAll":23,"./when":32}],6:[function(t,n,e){!function(t){t(function(t){var n=t("./when"),e=Array.prototype.slice;return r.n=function(t){var e=0,r=[];return function(){return n.promise(function(n){e<t?n(o):r.push(n),e+=1})};function o(){e=Math.max(e-1,0),r.length>0&&r.shift()(o)}},r;function r(t,r){return function(){var o=e.call(arguments);return n(t()).withThis(this).then(function(t){return n(r.apply(this,o)).finally(t)})}}})}(function(e){n.exports=e(t)})},{"./when":32}],7:[function(t,n,e){!function(t){"use strict";t(function(t){var n=t("./when"),e=n.Promise,r=n.resolve;return{all:n.lift(o),map:function(t,n){return r(t).then(function(t){return o(Object.keys(t).reduce(function(n,o){return n[o]=r(t[o]).fold(e,o),n},{}))});function e(t,e){return n(e,t)}},settle:function(t){var o=Object.keys(t),i={};if(0===o.length)return r(i);var u=e._defer(),c=e._handler(u),f=o.map(function(n){return t[n]});return n.settle(f).then(function(t){!function(t,n,e,r){for(var o=0;o<t.length;o++)e[t[o]]=n[o];r.resolve(e)}(o,t,i,c)}),u}};function o(t){for(var n,r=e._defer(),o=e._handler(r),i={},u=Object.keys(t),c=u.length,f=0;f<u.length;++f)n=u[f],e._handler(t[n]).fold(l,n,i,o);return 0===c&&o.resolve(i),r;function l(t,n,e){this[t]=n,0==--c&&e.resolve(i)}}})}(function(e){n.exports=e(t)})},{"./when":32}],8:[function(t,n,e){!function(t){"use strict";t(function(t){return t("./makePromise")({scheduler:new(t("./Scheduler"))(t("./env").asap)})})}(function(e){n.exports=e(t)})},{"./Scheduler":9,"./env":21,"./makePromise":24}],9:[function(t,n,e){!function(t){"use strict";t(function(){function t(t){this._async=t,this._running=!1,this._queue=this,this._queueLen=0,this._afterQueue={},this._afterQueueLen=0;var n=this;this.drain=function(){n._drain()}}return t.prototype.enqueue=function(t){this._queue[this._queueLen++]=t,this.run()},t.prototype.afterQueue=function(t){this._afterQueue[this._afterQueueLen++]=t,this.run()},t.prototype.run=function(){this._running||(this._running=!0,this._async(this.drain))},t.prototype._drain=function(){for(var t=0;t<this._queueLen;++t)this._queue[t].run(),this._queue[t]=void 0;for(this._queueLen=0,this._running=!1,t=0;t<this._afterQueueLen;++t)this._afterQueue[t].run(),this._afterQueue[t]=void 0;this._afterQueueLen=0},t})}(function(t){n.exports=t()})},{}],10:[function(t,n,e){!function(t){"use strict";t(function(){function t(n){Error.call(this),this.message=n,this.name=t.name,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t})}(function(t){n.exports=t()})},{}],11:[function(t,n,e){!function(t){"use strict";t(function(){return t.tryCatchResolve=n,t;function t(t,e){return arguments.length<2&&(e=n),function(n,o,i){var u=t._defer(),c=i.length,f=new Array(c);return r({f:n,thisArg:o,args:i,params:f,i:c-1,call:e},u._handler),u};function r(n,r){if(n.i<0)return e(n.f,n.thisArg,n.params,r);t._handler(n.args[n.i]).fold(o,n,void 0,r)}function o(t,n,e){t.params[t.i]=n,t.i-=1,r(t,e)}}function n(t,n,e,r){try{r.resolve(t.apply(n,e))}catch(o){r.reject(o)}}})}(function(t){n.exports=t()})},{}],12:[function(t,n,e){!function(t){"use strict";t(function(t){var n=t("../state"),e=t("../apply");return function(t){var r=e(t),o=t.resolve,i=t.all,u=Array.prototype.reduce,c=Array.prototype.reduceRight,f=Array.prototype.slice;return t.any=function(n){for(var e,r,o=t._defer(),i=o._handler,u=n.length>>>0,c=u,f=[],l=0;l<u;++l)if(void 0!==(r=n[l])||l in n){if((e=t._handler(r)).state()>0){i.become(e),t._visitRemaining(n,l,e);break}e.visit(i,s,a)}else--c;0===c&&i.reject(new RangeError("any(): array must not be empty"));return o;function s(t){f=null,this.resolve(t)}function a(t){this.resolved||(f.push(t),0==--c&&this.reject(f))}},t.some=function(n,e){var r,o,i,u=t._defer(),c=u._handler,f=[],l=[],s=n.length>>>0,a=0;for(i=0;i<s;++i)(void 0!==(o=n[i])||i in n)&&++a;e=Math.max(e,0),r=a-e+1,a=Math.min(e,a),e>a?c.reject(new RangeError("some(): array must contain at least "+e+" item(s), but had "+a)):0===a&&c.resolve(f);for(i=0;i<s;++i)(void 0!==(o=n[i])||i in n)&&t._handler(o).visit(c,h,p,c.notify);return u;function h(t){this.resolved||(f.push(t),0==--a&&(l=null,this.resolve(f)))}function p(t){this.resolved||(l.push(t),0==--r&&(f=null,this.reject(l)))}},t.settle=function(t){return i(t.map(l))},t.map=function(n,e){return t._traverse(e,n)},t.filter=function(n,e){var r=f.call(n);return t._traverse(e,r).then(function(n){return function(n,e){for(var r=e.length,o=new Array(r),i=0,u=0;i<r;++i)e[i]&&(o[u++]=t._handler(n[i]).value);return o.length=u,o}(r,n)})},t.reduce=function(t,n){return arguments.length>2?u.call(t,s(n),arguments[2]):u.call(t,s(n))},t.reduceRight=function(t,n){return arguments.length>2?c.call(t,s(n),arguments[2]):c.call(t,s(n))},t.prototype.spread=function(t){return this.then(i).then(function(n){return t.apply(this,n)})},t;function l(e){var r;return e instanceof t&&(r=e._handler.join()),r&&0===r.state()||!r?o(e).then(n.fulfilled,n.rejected):(r._unreport(),n.inspect(r))}function s(t){return function(n,e,o){return r(t,void 0,[n,e,o])}}}})}(function(e){n.exports=e(t)})},{"../apply":11,"../state":25}],13:[function(t,n,e){!function(t){"use strict";t(function(){return function(e){var r=e.resolve,o=e.reject,i=e.prototype.catch;function u(t,n,e,o){var i,u=t.call(n);return"object"!=typeof(i=u)&&"function"!=typeof i||null===i?e(o):function(t,n,e){return r(t).then(function(){return n(e)})}(u,e,o)}return e.prototype.done=function(t,n){this._handler.visit(this._handler.receiver,t,n)},e.prototype.catch=e.prototype.otherwise=function(n){return arguments.length<2?i.call(this,n):"function"!=typeof n?this.ensure(t):i.call(this,(e=arguments[1],r=n,function(t){return function(t,n){return function(t){return t===Error||null!=t&&t.prototype instanceof Error}(n)?t instanceof n:n(t)}(t,r)?e.call(this,t):o(t)}));var e,r},e.prototype.finally=e.prototype.ensure=function(t){return"function"!=typeof t?this:this.then(function(e){return u(t,this,n,e)},function(n){return u(t,this,o,n)})},e.prototype.else=e.prototype.orElse=function(t){return this.then(void 0,function(){return t})},e.prototype.yield=function(t){return this.then(function(){return t})},e.prototype.tap=function(t){return this.then(t).yield(this)},e};function t(){throw new TypeError("catch predicate must be a function")}function n(t){return t}})}(function(t){n.exports=t()})},{}],14:[function(t,n,e){!function(t){"use strict";t(function(){return function(t){return t.prototype.fold=function(n,e){var r=this._beget();return this._handler.fold(function(e,r,o){t._handler(e).fold(function(t,e,r){r.resolve(n.call(this,e,t))},r,this,o)},e,r._handler.receiver,r._handler),r},t}})}(function(t){n.exports=t()})},{}],15:[function(t,n,e){!function(t){"use strict";t(function(t){var n=t("../state").inspect;return function(t){return t.prototype.inspect=function(){return n(t._handler(this))},t}})}(function(e){n.exports=e(t)})},{"../state":25}],16:[function(t,n,e){!function(t){"use strict";t(function(){return function(t){var n=t.resolve;return t.iterate=function(t,n,r,o){return e(function(n){return[n,t(n)]},n,r,o)},t.unfold=e,t;function e(t,r,o,i){return n(i).then(function(e){return n(r(e)).then(function(r){return r?e:n(t(e)).spread(u)})});function u(i,u){return n(o(i)).then(function(){return e(t,r,o,u)})}}}})}(function(t){n.exports=t()})},{}],17:[function(t,n,e){!function(t){"use strict";t(function(){return function(t){return t.prototype.progress=function(t){return this.then(void 0,void 0,t)},t}})}(function(t){n.exports=t()})},{}],18:[function(t,n,e){!function(t){"use strict";t(function(t){var n=t("../env"),e=t("../TimeoutError");function r(t,e,r,o){return n.setTimer(function(){t(r,o,e)},e)}return function(t){function o(t,n,e){r(i,t,n,e)}function i(t,n){n.resolve(t)}function u(t,n,r){var o=void 0===t?new e("timed out after "+r+"ms"):t;n.reject(o)}return t.prototype.delay=function(t){var n=this._beget();return this._handler.fold(o,t,void 0,n._handler),n},t.prototype.timeout=function(t,e){var o=this._beget(),i=o._handler,c=r(u,t,e,o._handler);return this._handler.visit(i,function(t){n.clearTimer(c),this.resolve(t)},function(t){n.clearTimer(c),this.reject(t)},i.notify),o},t}})}(function(e){n.exports=e(t)})},{"../TimeoutError":10,"../env":21}],19:[function(t,n,e){!function(t){"use strict";t(function(t){var n=t("../env").setTimer,e=t("../format");return function(t){var i,u=o,c=o;"undefined"!=typeof console&&(i=console,u=void 0!==i.error?function(t){i.error(t)}:function(t){i.log(t)},c=void 0!==i.info?function(t){i.info(t)}:function(t){i.log(t)}),t.onPotentiallyUnhandledRejection=function(t){p(a,t)},t.onPotentiallyUnhandledRejectionHandled=function(t){p(h,t)},t.onFatalRejection=function(t){p(r,t.value)};var f=[],l=[],s=null;function a(t){t.handled||(l.push(t),u("Potentially unhandled rejection ["+t.id+"] "+e.formatError(t.value)))}function h(t){var n=l.indexOf(t);n>=0&&(l.splice(n,1),c("Handled previous rejection ["+t.id+"] "+e.formatObject(t.value)))}function p(t,e){f.push(t,e),null===s&&(s=n(d,0))}function d(){for(s=null;f.length>0;)f.shift()(f.shift())}return t};function r(t){throw t}function o(){}})}(function(e){n.exports=e(t)})},{"../env":21,"../format":22}],20:[function(t,n,e){!function(t){"use strict";t(function(){return function(t){return t.prototype.with=t.prototype.withThis=function(t){var n=this._beget(),e=n._handler;return e.receiver=t,this._handler.chain(e,t),n},t}})}(function(t){n.exports=t()})},{}],21:[function(t,n,r){!function(t){"use strict";t(function(t){var n,r="undefined"!=typeof setTimeout&&setTimeout,o=function(t,n){return setTimeout(t,n)},i=function(t){return clearTimeout(t)},u=function(t){return r(t,0)};if(void 0!==e&&"[object process]"===Object.prototype.toString.call(e))u=function(t){return e.nextTick(t)};else if(n="undefined"!=typeof MutationObserver&&MutationObserver||"undefined"!=typeof WebKitMutationObserver&&WebKitMutationObserver)u=function(t){var n,e=document.createTextNode("");new t(function(){var t=n;n=void 0,t()}).observe(e,{characterData:!0});var r=0;return function(t){n=t,e.data=r^=1}}(n);else if(!r){var c=t("vertx");o=function(t,n){return c.setTimer(n,t)},i=c.cancelTimer,u=c.runOnLoop||c.runOnContext}return{setTimer:o,clearTimer:i,asap:u}})}(function(e){n.exports=e(t)})},{}],22:[function(t,n,e){!function(t){"use strict";t(function(){return{formatError:function(n){var e="object"==typeof n&&null!==n&&(n.stack||n.message)?n.stack||n.message:t(n);return n instanceof Error?e:e+" (WARNING: non-Error used)"},formatObject:t,tryStringify:n};function t(t){var e=String(t);return"[object Object]"===e&&"undefined"!=typeof JSON&&(e=n(t,e)),e}function n(t,n){try{return JSON.stringify(t)}catch(e){return n}}})}(function(t){n.exports=t()})},{}],23:[function(t,n,e){!function(t){"use strict";t(function(){return function(n,e,r,o){return void 0===e&&(e=t),Object.keys(o).reduce(function(t,r){var i=o[r];return"function"==typeof i?e(t,n(i),r):t},void 0===r?function(t){return"function"==typeof t?t.bind():Object.create(t)}(o):r)};function t(t,n,e){return t[e]=n,t}})}(function(t){n.exports=t()})},{}],24:[function(t,n,r){!function(t){"use strict";t(function(){return function(t){var n=t.scheduler,r=function(){if(null!=e&&"function"==typeof e.emit)return function(t,n){return"unhandledRejection"===t?e.emit(t,n.value,n):e.emit(t,n)};if("undefined"!=typeof self&&function(){if("function"==typeof CustomEvent)try{var t=new CustomEvent("unhandledRejection");return t instanceof CustomEvent}catch(n){}return!1}())return function(t,n){return function(e,r){var o=new n(e,{detail:{reason:r.value,key:r},bubbles:!1,cancelable:!0});return!t.dispatchEvent(o)}}(self,CustomEvent);if("undefined"!=typeof self&&function(){if("undefined"!=typeof document&&"function"==typeof document.createEvent)try{var t=document.createEvent("CustomEvent");return t.initCustomEvent("eventType",!1,!0,{}),!0}catch(n){}return!1}())return function(t,n){return function(e,r){var o=n.createEvent("CustomEvent");return o.initCustomEvent(e,!1,!0,{reason:r.value,key:r}),!t.dispatchEvent(o)}}(self,document);return N}(),o=Object.create||function(t){function n(){}return n.prototype=t,new n};function i(t,n){this._handler=t===v?n:function(t){var n=new b;try{t(function(t){n.resolve(t)},e,function(t){n.notify(t)})}catch(r){e(r)}return n;function e(t){n.reject(t)}}(t)}function u(t){return P(t)?t:new i(v,new _(p(t)))}function c(t){return new i(v,new _(new x(t)))}function f(){return T}function l(t,n,e){for(var r,o="function"==typeof n?function(r,o,i){i.resolved||s(e,a,r,t(n,o,r),i)}:a,u=new b,c=e.length>>>0,f=new Array(c),l=0;l<e.length&&!u.resolved;++l)void 0!==(r=e[l])||l in e?s(e,o,l,r,u):--c;return 0===c&&u.become(new j(f)),new i(v,u);function a(t,n,e){f[t]=n,0==--c&&e.become(new j(f))}}function s(t,n,e,r,o){if(Q(r)){var i=function(t){return P(t)?t._handler.join():d(t)}(r),u=i.state();0===u?i.fold(n,e,void 0,o):u>0?n(e,i.value,o):(o.become(i),a(t,e+1,i))}else n(e,r,o)}function a(t,n,e){for(var r=n;r<t.length;++r)h(p(t[r]),e)}function h(t,n){if(t!==n){var e=t.state();0===e?t.visit(t,void 0,t._unreport):e<0&&t._unreport()}}function p(t){return P(t)?t._handler.join():Q(t)?d(t):new j(t)}function d(t){try{var n=t.then;return"function"==typeof n?new w(n,t):new j(t)}catch(e){return new x(e)}}function v(){}function y(){}i.resolve=u,i.reject=c,i.never=f,i._defer=function(){return new i(v,new b)},i._handler=p,i.prototype.then=function(t,n,e){var r=this._handler,o=r.join().state();if("function"!=typeof t&&o>0||"function"!=typeof n&&o<0)return new this.constructor(v,r);var i=this._beget(),u=i._handler;return r.chain(u,r.receiver,t,n,e),i},i.prototype.catch=function(t){return this.then(void 0,t)},i.prototype._beget=function(){return t=this._handler,n=this.constructor,e=new b(t.receiver,t.join().context),new n(v,e);var t,n,e},i.all=function(t){return l(H,null,t)},i.race=function(t){if("object"!=typeof t||null===t)return c(new TypeError("non-iterable passed to race()"));return 0===t.length?f():1===t.length?u(t[0]):function(t){var n,e,r,o=new b;for(n=0;n<t.length;++n)if(void 0!==(e=t[n])||n in t){if(0!==(r=p(e)).state()){o.become(r),a(t,n+1,r);break}r.visit(o,o.resolve,o.reject)}return new i(v,o)}(t)},i._traverse=function(t,n){return l(M,t,n)},i._visitRemaining=a,v.prototype.when=v.prototype.become=v.prototype.notify=v.prototype.fail=v.prototype._unreport=v.prototype._report=N,v.prototype._state=0,v.prototype.state=function(){return this._state},v.prototype.join=function(){for(var t=this;void 0!==t.handler;)t=t.handler;return t},v.prototype.chain=function(t,n,e,r,o){this.when({resolver:t,receiver:n,fulfilled:e,rejected:r,progress:o})},v.prototype.visit=function(t,n,e,r){this.chain(m,t,n,e,r)},v.prototype.fold=function(t,n,e,r){this.when(new O(t,n,e,r))},U(v,y),y.prototype.become=function(t){t.fail()};var m=new y;function b(t,n){i.createContext(this,n),this.consumers=void 0,this.receiver=t,this.handler=void 0,this.resolved=!1}function _(t){this.handler=t}function w(t,e){b.call(this),n.enqueue(new q(t,e,this))}function j(t){i.createContext(this),this.value=t}U(v,b),b.prototype._state=0,b.prototype.resolve=function(t){this.become(p(t))},b.prototype.reject=function(t){this.resolved||this.become(new x(t))},b.prototype.join=function(){if(!this.resolved)return this;for(var t=this;void 0!==t.handler;)if((t=t.handler)===this)return this.handler=new x(new TypeError("Promise cycle"));return t},b.prototype.run=function(){var t=this.consumers,n=this.handler;this.handler=this.handler.join(),this.consumers=void 0;for(var e=0;e<t.length;++e)n.when(t[e])},b.prototype.become=function(t){this.resolved||(this.resolved=!0,this.handler=t,void 0!==this.consumers&&n.enqueue(this),void 0!==this.context&&t._report(this.context))},b.prototype.when=function(t){this.resolved?n.enqueue(new C(t,this.handler)):void 0===this.consumers?this.consumers=[t]:this.consumers.push(t)},b.prototype.notify=function(t){this.resolved||n.enqueue(new R(t,this))},b.prototype.fail=function(t){var n=void 0===t?this.context:t;this.resolved&&this.handler.join().fail(n)},b.prototype._report=function(t){this.resolved&&this.handler.join()._report(t)},b.prototype._unreport=function(){this.resolved&&this.handler.join()._unreport()},U(v,_),_.prototype.when=function(t){n.enqueue(new C(t,this))},_.prototype._report=function(t){this.join()._report(t)},_.prototype._unreport=function(){this.join()._unreport()},U(b,w),U(v,j),j.prototype._state=1,j.prototype.fold=function(t,n,e,r){!function(t,n,e,r,o){if("function"!=typeof t)return o.become(e);i.enterContext(e),function(t,n,e,r,o){try{t.call(r,n,e,o)}catch(i){o.become(new x(i))}}(t,n,e.value,r,o),i.exitContext()}(t,n,this,e,r)},j.prototype.when=function(t){L(t.fulfilled,this,t.receiver,t.resolver)};var g=0;function x(t){i.createContext(this),this.id=++g,this.value=t,this.handled=!1,this.reported=!1,this._report()}function E(t,n){this.rejection=t,this.context=n}function k(t){this.rejection=t}U(v,x),x.prototype._state=-1,x.prototype.fold=function(t,n,e,r){r.become(this)},x.prototype.when=function(t){"function"==typeof t.rejected&&this._unreport(),L(t.rejected,this,t.receiver,t.resolver)},x.prototype._report=function(t){n.afterQueue(new E(this,t))},x.prototype._unreport=function(){this.handled||(this.handled=!0,n.afterQueue(new k(this)))},x.prototype.fail=function(t){this.reported=!0,r("unhandledRejection",this),i.onFatalRejection(this,void 0===t?this.context:t)},E.prototype.run=function(){this.rejection.handled||this.rejection.reported||(this.rejection.reported=!0,r("unhandledRejection",this.rejection)||i.onPotentiallyUnhandledRejection(this.rejection,this.context))},k.prototype.run=function(){this.rejection.reported&&(r("rejectionHandled",this.rejection)||i.onPotentiallyUnhandledRejectionHandled(this.rejection))},i.createContext=i.enterContext=i.exitContext=i.onPotentiallyUnhandledRejection=i.onPotentiallyUnhandledRejectionHandled=i.onFatalRejection=N;var A=new v,T=new i(v,A);function C(t,n){this.continuation=t,this.handler=n}function R(t,n){this.handler=n,this.value=t}function q(t,n,e){this._then=t,this.thenable=n,this.resolver=e}function O(t,n,e,r){this.f=t,this.z=n,this.c=e,this.to=r,this.resolver=m,this.receiver=this}function P(t){return t instanceof i}function Q(t){return("object"==typeof t||"function"==typeof t)&&null!==t}function L(t,n,e,r){if("function"!=typeof t)return r.become(n);i.enterContext(n),function(t,n,e,r){try{r.become(p(t.call(e,n)))}catch(o){r.become(new x(o))}}(t,n.value,e,r),i.exitContext()}function S(t,n,e,r,o){if("function"!=typeof t)return o.notify(n);i.enterContext(e),function(t,n,e,r){try{r.notify(t.call(e,n))}catch(o){r.notify(o)}}(t,n,r,o),i.exitContext()}function M(t,n,e){try{return t(n,e)}catch(r){return c(r)}}function U(t,n){n.prototype=o(t.prototype),n.prototype.constructor=n}function H(t,n){return n}function N(){}return C.prototype.run=function(){this.handler.join().when(this.continuation)},R.prototype.run=function(){var t=this.handler.consumers;if(void 0!==t)for(var n,e=0;e<t.length;++e)S((n=t[e]).progress,this.value,this.handler,n.receiver,n.resolver)},q.prototype.run=function(){var t=this.resolver;!function(t,n,e,r,o){try{t.call(n,e,r,o)}catch(i){r(i)}}(this._then,this.thenable,function(n){t.resolve(n)},function(n){t.reject(n)},function(n){t.notify(n)})},O.prototype.fulfilled=function(t){this.f.call(this.c,this.z,t,this.to)},O.prototype.rejected=function(t){this.to.reject(t)},O.prototype.progress=function(t){this.to.notify(t)},i}})}(function(t){n.exports=t()})},{}],25:[function(t,n,e){!function(t){"use strict";t(function(){return{pending:t,fulfilled:e,rejected:n,inspect:function(t){var r=t.state();return 0===r?{state:"pending"}:r>0?e(t.value):n(t.value)}};function t(){return{state:"pending"}}function n(t){return{state:"rejected",reason:t}}function e(t){return{state:"fulfilled",value:t}}})}(function(t){n.exports=t()})},{}],26:[function(t,n,e){!function(t){t(function(t){var n=t("./when"),e=t("./lib/liftAll"),r=t("./lib/env").setTimer,o=Array.prototype.slice,i=t("./lib/apply")(n.Promise,function(t,n,e,r){var o=c(r);try{switch(e.length){case 2:t.call(n,e[0],e[1],o);break;case 1:t.call(n,e[0],o);break;case 0:t.call(n,o);break;default:e.push(o),t.apply(n,e)}}catch(i){r.reject(i)}});return{lift:u,liftAll:function(t,n,r){return e(u,n,r,t)},apply:function(t,n){return i(t,this,n||[])},call:function(t){return i(t,this,o.call(arguments,1))},createCallback:c,bindCallback:f,liftCallback:function(t){return function(n){return f(n,t)}}};function u(t){var n=arguments.length>1?o.call(arguments,1):[];return function(){var e,r=n.length,o=arguments.length,u=new Array(o+r);for(e=0;e<r;++e)u[e]=n[e];for(e=0;e<o;++e)u[e+r]=arguments[e];return i(t,this,u)}}function c(t){return function(n,e){n?t.reject(n):arguments.length>2?t.resolve(o.call(arguments,1)):t.resolve(e)}}function f(t,e){return t=n(t),e&&t.then(function(t){o(null,t)},o),t;function o(t,n){r(function(){e(t,n)},0)}}})}(function(e){n.exports=e(t)})},{"./lib/apply":11,"./lib/env":21,"./lib/liftAll":23,"./when":32}],27:[function(t,n,e){!function(t){t(function(t){var n=t("./when"),e=n.Promise.all,r=Array.prototype.slice;return function(t){return e(r.call(arguments,1)).then(function(e){return n.map(t,function(t){return t.apply(void 0,e)})})}})}(function(e){n.exports=e(t)})},{"./when":32}],28:[function(t,n,e){!function(t){t(function(t){var n=t("./when"),e=n.Promise.all,r=Array.prototype.slice;return function(t){var o=function(t,n){return o=function(t,n){return n(t)},n.apply(null,t)};return e(r.call(arguments,1)).then(function(e){return n.reduce(t,function(t,n){return o(t,n)},e)})}})}(function(e){n.exports=e(t)})},{"./when":32}],29:[function(t,n,e){!function(t){"use strict";t(function(t){var n=t("./when"),e=n.try,r=t("./cancelable");return function(t,o,i,u){var c,f,l;function s(t){e(o).then(a,l),void 0!==t&&c.notify(t)}function a(){f||n(t(),function(t){n(i(t),function(n){return n?function(t){c.resolve(t)}(t):s(t)},function(){s(t)})},l)}return f=!1,c=r(n.defer(),function(){f=!0}),l=c.reject,i=i||function(){return!1},"function"!=typeof o&&(o=function(t){return function(){return n().delay(t)}}(o)),u?s():a(),c.promise=Object.create(c.promise),c.promise.cancel=c.cancel,c.promise}})}(function(e){n.exports=e(t)})},{"./cancelable":3,"./when":32}],30:[function(t,n,e){!function(t){t(function(t){var n=t("./when"),e=n.Promise.all,r=Array.prototype.slice;return function(t){var o=[];return e(r.call(arguments,1)).then(function(e){return n.reduce(t,function(t,r){return n(r.apply(void 0,e),i)},o)});function i(t){return o.push(t),o}}})}(function(e){n.exports=e(t)})},{"./when":32}],31:[function(t,n,e){!function(t){t(function(t){var n=t("./when");return function(t,e){return n(e).timeout(t)}})}(function(e){n.exports=e(t)})},{"./when":32}],32:[function(t,n,e){!function(t){"use strict";t(function(t){var n=t("./lib/decorators/timed"),e=t("./lib/decorators/array"),r=t("./lib/decorators/flow"),o=t("./lib/decorators/fold"),i=t("./lib/decorators/inspect"),u=t("./lib/decorators/iterate"),c=t("./lib/decorators/progress"),f=t("./lib/decorators/with"),l=t("./lib/decorators/unhandledRejection"),s=t("./lib/TimeoutError"),a=[e,r,o,u,c,i,f,n,l].reduce(function(t,n){return n(t)},t("./lib/Promise")),h=t("./lib/apply")(a);function p(t,n,e,r){var o=a.resolve(t);return arguments.length<2?o:o.then(n,e,r)}function d(t){return function(){for(var n=0,e=arguments.length,r=new Array(e);n<e;++n)r[n]=arguments[n];return h(t,this,r)}}function v(t){for(var n=0,e=arguments.length-1,r=new Array(e);n<e;++n)r[n]=arguments[n+1];return h(t,this,r)}function y(){var t=a._defer();function n(n){t._handler.resolve(n)}function e(n){t._handler.reject(n)}function r(n){t._handler.notify(n)}this.promise=t,this.resolve=n,this.reject=e,this.notify=r,this.resolver={resolve:n,reject:e,notify:r}}return p.promise=function(t){return new a(t)},p.resolve=a.resolve,p.reject=a.reject,p.lift=d,p.try=v,p.attempt=v,p.iterate=a.iterate,p.unfold=a.unfold,p.join=function(){return a.all(arguments)},p.all=function(t){return p(t,a.all)},p.settle=function(t){return p(t,a.settle)},p.any=d(a.any),p.some=d(a.some),p.race=d(a.race),p.map=function(t,n){return p(t,function(t){return a.map(t,n)})},p.filter=function(t,n){return p(t,function(t){return a.filter(t,n)})},p.reduce=d(a.reduce),p.reduceRight=d(a.reduceRight),p.isPromiseLike=function(t){return t&&"function"==typeof t.then},p.Promise=a,p.defer=function(){return new y},p.TimeoutError=s,p})}(function(e){n.exports=e(t)})},{"./lib/Promise":8,"./lib/TimeoutError":10,"./lib/apply":11,"./lib/decorators/array":12,"./lib/decorators/flow":13,"./lib/decorators/fold":14,"./lib/decorators/inspect":15,"./lib/decorators/iterate":16,"./lib/decorators/progress":17,"./lib/decorators/timed":18,"./lib/decorators/unhandledRejection":19,"./lib/decorators/with":20}]},{},[1])(1)});
},{"process":"uDgH"}],"XGGi":[function(require,module,exports) {

},{}],"Ilsz":[function(require,module,exports) {
module.exports=function(o){return o&&"object"==typeof o&&"function"==typeof o.copy&&"function"==typeof o.fill&&"function"==typeof o.readUInt8};
},{}],"cC36":[function(require,module,exports) {
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};
},{}],"Zc5Q":[function(require,module,exports) {
var process = require("process");
var e=require("process"),t=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},r=/%[sdj%]/g;exports.format=function(e){if(!v(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(" ")}n=1;for(var o=arguments,u=o.length,s=String(e).replace(r,function(e){if("%%"===e)return"%";if(n>=u)return e;switch(e){case"%s":return String(o[n++]);case"%d":return Number(o[n++]);case"%j":try{return JSON.stringify(o[n++])}catch(t){return"[Circular]"}default:return e}}),c=o[n];n<u;c=o[++n])h(c)||!S(c)?s+=" "+c:s+=" "+i(c);return s},exports.deprecate=function(t,r){if(void 0!==e&&!0===e.noDeprecation)return t;if(void 0===e)return function(){return exports.deprecate(t,r).apply(this,arguments)};var n=!1;return function(){if(!n){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),n=!0}return t.apply(this,arguments)}};var n,o={};function i(e,t){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),b(t)?r.showHidden=t:t&&exports._extend(r,t),j(r.showHidden)&&(r.showHidden=!1),j(r.depth)&&(r.depth=2),j(r.colors)&&(r.colors=!1),j(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),p(r,e,r.depth)}function u(e,t){var r=i.styles[t];return r?"["+i.colors[r][0]+"m"+e+"["+i.colors[r][1]+"m":e}function s(e,t){return e}function c(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}function p(e,t,r){if(e.customInspect&&t&&P(t.inspect)&&t.inspect!==exports.inspect&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return v(n)||(n=p(e,n,r)),n}var o=l(e,t);if(o)return o;var i=Object.keys(t),u=c(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(t)),E(t)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return f(t);if(0===i.length){if(P(t)){var s=t.name?": "+t.name:"";return e.stylize("[Function"+s+"]","special")}if(w(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(z(t))return e.stylize(Date.prototype.toString.call(t),"date");if(E(t))return f(t)}var b,h="",m=!1,x=["{","}"];(d(t)&&(m=!0,x=["[","]"]),P(t))&&(h=" [Function"+(t.name?": "+t.name:"")+"]");return w(t)&&(h=" "+RegExp.prototype.toString.call(t)),z(t)&&(h=" "+Date.prototype.toUTCString.call(t)),E(t)&&(h=" "+f(t)),0!==i.length||m&&0!=t.length?r<0?w(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),b=m?a(e,t,r,u,i):i.map(function(n){return y(e,t,r,u,n,m)}),e.seen.pop(),g(b,h,x)):x[0]+h+x[1]}function l(e,t){if(j(t))return e.stylize("undefined","undefined");if(v(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return x(t)?e.stylize(""+t,"number"):b(t)?e.stylize(""+t,"boolean"):h(t)?e.stylize("null","null"):void 0}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function a(e,t,r,n,o){for(var i=[],u=0,s=t.length;u<s;++u)A(t,String(u))?i.push(y(e,t,r,n,String(u),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(y(e,t,r,n,o,!0))}),i}function y(e,t,r,n,o,i){var u,s,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),A(n,o)||(u="["+o+"]"),s||(e.seen.indexOf(c.value)<0?(s=h(r)?p(e,c.value,null):p(e,c.value,r-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),j(u)){if(i&&o.match(/^\d+$/))return s;(u=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(u=u.substr(1,u.length-2),u=e.stylize(u,"name")):(u=u.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),u=e.stylize(u,"string"))}return u+": "+s}function g(e,t,r){return e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}function d(e){return Array.isArray(e)}function b(e){return"boolean"==typeof e}function h(e){return null===e}function m(e){return null==e}function x(e){return"number"==typeof e}function v(e){return"string"==typeof e}function O(e){return"symbol"==typeof e}function j(e){return void 0===e}function w(e){return S(e)&&"[object RegExp]"===T(e)}function S(e){return"object"==typeof e&&null!==e}function z(e){return S(e)&&"[object Date]"===T(e)}function E(e){return S(e)&&("[object Error]"===T(e)||e instanceof Error)}function P(e){return"function"==typeof e}function D(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function T(e){return Object.prototype.toString.call(e)}function N(e){return e<10?"0"+e.toString(10):e.toString(10)}exports.debuglog=function(t){if(j(n)&&(n=""),t=t.toUpperCase(),!o[t])if(new RegExp("\\b"+t+"\\b","i").test(n)){var r=e.pid;o[t]=function(){var e=exports.format.apply(exports,arguments);console.error("%s %d: %s",t,r,e)}}else o[t]=function(){};return o[t]},exports.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=d,exports.isBoolean=b,exports.isNull=h,exports.isNullOrUndefined=m,exports.isNumber=x,exports.isString=v,exports.isSymbol=O,exports.isUndefined=j,exports.isRegExp=w,exports.isObject=S,exports.isDate=z,exports.isError=E,exports.isFunction=P,exports.isPrimitive=D,exports.isBuffer=require("./support/isBuffer");var F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function k(){var e=new Date,t=[N(e.getHours()),N(e.getMinutes()),N(e.getSeconds())].join(":");return[e.getDate(),F[e.getMonth()],t].join(" ")}function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}exports.log=function(){console.log("%s - %s",k(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(e,t){if(!t||!S(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var J="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function R(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}function H(r){if("function"!=typeof r)throw new TypeError('The "original" argument must be of type Function');function n(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);var o=t.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,u=function(){return o.apply(i,arguments)};r.apply(this,t).then(function(t){e.nextTick(u,null,t)},function(t){e.nextTick(R,t,u)})}return Object.setPrototypeOf(n,Object.getPrototypeOf(r)),Object.defineProperties(n,t(r)),n}exports.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(J&&e[J]){var r;if("function"!=typeof(r=e[J]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(r,J,{value:r,enumerable:!1,writable:!1,configurable:!0}),r}function r(){for(var t,r,n=new Promise(function(e,n){t=e,r=n}),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push(function(e,n){e?r(e):t(n)});try{e.apply(this,o)}catch(u){r(u)}return n}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),J&&Object.defineProperty(r,J,{value:r,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(r,t(e))},exports.promisify.custom=J,exports.callbackify=H;
},{"./support/isBuffer":"Ilsz","inherits":"cC36","process":"uDgH"}],"kIfG":[function(require,module,exports) {
var e=require("util"),o={empty_input_filepath:{code:100,msg:"The input file path can not be empty"},input_filepath_must_be_string:{code:101,msg:"The input file path must be a string"},invalid_option_name:{code:102,msg:'The option "%s" is invalid. Check the list of available options'},fileinput_not_exist:{code:103,msg:"The input file does not exist"},format_not_supported:{code:104,msg:'The format "$s" is not supported by the version of ffmpeg'},audio_channel_is_invalid:{code:105,msg:'The audio channel "$s" is not valid'},mkdir:{code:106,msg:"Error occurred during creation folder: $s"},extract_frame_invalid_everyN_options:{code:107,msg:"You can specify only one option between everyNFrames and everyNSeconds"},invalid_watermark:{code:108,msg:'The watermark "%s" does not exists'},invalid_watermark_position:{code:109,msg:'Invalid watermark position "%s"'},size_format:{code:110,msg:'The format "%s" not supported by the function "setSize"'},resolution_square_not_defined:{code:111,msg:"The resolution for pixel aspect ratio is not defined"},command_already_exists:{code:112,msg:'The command "%s" already exists'},codec_not_supported:{code:113,msg:'The codec "$s" is not supported by the version of ffmpeg'}},t=function(t){var i=[o[t].msg];return arguments.length>1&&(i=i.concat(Array.prototype.slice.call(arguments,1))),{code:o[t].code,msg:e.format.apply(this,i)}};module.exports.list=o,module.exports.renderError=t;
},{"util":"Zc5Q"}],"yL0h":[function(require,module,exports) {
var process = require("process");
var r=require("process");function t(r,t){for(var e=0,n=r.length-1;n>=0;n--){var o=r[n];"."===o?r.splice(n,1):".."===o?(r.splice(n,1),e++):e&&(r.splice(n,1),e--)}if(t)for(;e--;e)r.unshift("..");return r}function e(r){"string"!=typeof r&&(r+="");var t,e=0,n=-1,o=!0;for(t=r.length-1;t>=0;--t)if(47===r.charCodeAt(t)){if(!o){e=t+1;break}}else-1===n&&(o=!1,n=t+1);return-1===n?"":r.slice(e,n)}function n(r,t){if(r.filter)return r.filter(t);for(var e=[],n=0;n<r.length;n++)t(r[n],n,r)&&e.push(r[n]);return e}exports.resolve=function(){for(var e="",o=!1,s=arguments.length-1;s>=-1&&!o;s--){var i=s>=0?arguments[s]:r.cwd();if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,o="/"===i.charAt(0))}return(o?"/":"")+(e=t(n(e.split("/"),function(r){return!!r}),!o).join("/"))||"."},exports.normalize=function(r){var e=exports.isAbsolute(r),s="/"===o(r,-1);return(r=t(n(r.split("/"),function(r){return!!r}),!e).join("/"))||e||(r="."),r&&s&&(r+="/"),(e?"/":"")+r},exports.isAbsolute=function(r){return"/"===r.charAt(0)},exports.join=function(){var r=Array.prototype.slice.call(arguments,0);return exports.normalize(n(r,function(r,t){if("string"!=typeof r)throw new TypeError("Arguments to path.join must be strings");return r}).join("/"))},exports.relative=function(r,t){function e(r){for(var t=0;t<r.length&&""===r[t];t++);for(var e=r.length-1;e>=0&&""===r[e];e--);return t>e?[]:r.slice(t,e-t+1)}r=exports.resolve(r).substr(1),t=exports.resolve(t).substr(1);for(var n=e(r.split("/")),o=e(t.split("/")),s=Math.min(n.length,o.length),i=s,u=0;u<s;u++)if(n[u]!==o[u]){i=u;break}var f=[];for(u=i;u<n.length;u++)f.push("..");return(f=f.concat(o.slice(i))).join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(r){if("string"!=typeof r&&(r+=""),0===r.length)return".";for(var t=r.charCodeAt(0),e=47===t,n=-1,o=!0,s=r.length-1;s>=1;--s)if(47===(t=r.charCodeAt(s))){if(!o){n=s;break}}else o=!1;return-1===n?e?"/":".":e&&1===n?"/":r.slice(0,n)},exports.basename=function(r,t){var n=e(r);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},exports.extname=function(r){"string"!=typeof r&&(r+="");for(var t=-1,e=0,n=-1,o=!0,s=0,i=r.length-1;i>=0;--i){var u=r.charCodeAt(i);if(47!==u)-1===n&&(o=!1,n=i+1),46===u?-1===t?t=i:1!==s&&(s=1):-1!==t&&(s=-1);else if(!o){e=i+1;break}}return-1===t||-1===n||0===s||1===s&&t===n-1&&t===e+1?"":r.slice(t,n)};var o="b"==="ab".substr(-1)?function(r,t,e){return r.substr(t,e)}:function(r,t,e){return t<0&&(t=r.length+t),r.substr(t,e)};
},{"process":"uDgH"}],"X5rs":[function(require,module,exports) {
var process = require("process");
var r=require("process"),e=require("child_process").exec,o=require("fs"),t=require("path"),i=require("./errors");module.exports.exec=function(r,o,t){var i=r.join(" "),n=null,u=e(i,o,function(r,e,o){null!==n&&clearTimeout(n),t(r,e,o)});o.timeout>0&&(n=setTimeout(function(){u.kill()},100))},module.exports.isEmptyObj=function(r){for(var e in r)if(r.hasOwnProperty(e))return!1;return!0},module.exports.mergeObject=function(r,e){if(!module.exports.isEmptyObj(e))for(var o in e){if(!r.hasOwnProperty(o))throw i.renderError("invalid_option_name",o);r[o]=e[o]}},module.exports.durationToSeconds=function(r){var e=r.substr(0,8).split(":");return 3600*parseInt(e[0],10)+60*parseInt(e[1],10)+parseInt(e[2],10)},module.exports.gcd=function(r,e){return 0===e?r:module.exports.gcd(e,r%e)},module.exports.mkdir=function(r,e,n,u){var s=t.normalize(r).split("/");if(""==s[0]&&(s=s.slice(1)),e=e||511,(u=u||0)>s.length)return n&&n(),!0;var l=("/"==r.charAt(0)?"/":"")+s.slice(0,u+1).join("/");if(o.existsSync(l))module.exports.mkdir(r,e,n,u+1);else{if(o.mkdirSync(l,e))throw n&&n(i.renderError("mkdir",l)),i.renderError("mkdir",l);module.exports.mkdir(r,e,n,u+1)}},module.exports.in_array=function(r,e){for(var o in e)if(e[o]==r)return o;return!1};
},{"child_process":"XGGi","fs":"XGGi","path":"yL0h","./errors":"kIfG","process":"uDgH"}],"cOiA":[function(require,module,exports) {
module.exports=function(){this.encoding="utf8",this.timeout=0,this.maxBuffer=204800};
},{}],"MiK0":[function(require,module,exports) {
module.exports.size={SQCIF:"128x96",QCIF:"176x144",CIF:"352x288","4CIF":"704x576",QQVGA:"160x120",QVGA:"320x240",VGA:"640x480",SVGA:"800x600",XGA:"1024x768",UXGA:"1600x1200",QXGA:"2048x1536",SXGA:"1280x1024",QSXGA:"2560x2048",HSXGA:"5120x4096",WVGA:"852x480",WXGA:"1366x768",WSXGA:"1600x1024",WUXGA:"1920x1200",WOXGA:"2560x1600",WQSXGA:"3200x2048",WQUXGA:"3840x2400",WHSXGA:"6400x4096",WHUXGA:"7680x4800",CGA:"320x200",EGA:"640x350",HD480:"852x480",HD720:"1280x720",HD1080:"1920x1080"},module.exports.ratio={"4:3":1.33,"3:2":1.5,"14:9":1.56,"16:9":1.78,"21:9":2.33},module.exports.audio_channel={mono:1,stereo:2};
},{}],"cZQY":[function(require,module,exports) {
var e=require("fs"),a=require("path"),i=require("when"),t=require("./errors"),n=require("./presets"),r=require("./utils");module.exports=function(o,s,d,l){this.file_path=o,this.info_configuration=d,this.metadata=l;var m=new Array,u=new Array,c=new Array,_=null,h=new Object;this.addCommand=function(e,a){if(!1!==r.in_array(e,m))throw t.renderError("command_already_exists",e);m.push(e),null!=a&&m.push(a)},this.addInput=function(e){u.push(e)},this.addFilterComplex=function(e){c.push(e)};var p=function(e){_=e};this.setDisableAudio=function(){return null==h.audio&&(h.audio=new Object),h.audio.disabled=!0,this},this.setDisableVideo=function(){return null==h.video&&(h.video=new Object),h.video.disabled=!0,this},this.setVideoFormat=function(e){if(-1!=this.info_configuration.encode.indexOf(e))return null==h.video&&(h.video=new Object),h.video.format=e,this;throw t.renderError("format_not_supported",e)},this.setVideoCodec=function(e){if(-1!=this.info_configuration.encode.indexOf(e))return null==h.video&&(h.video=new Object),h.video.codec=e,this;throw t.renderError("codec_not_supported",e)},this.setVideoBitRate=function(e){return null==h.video&&(h.video=new Object),h.video.bitrate=e,this},this.setVideoFrameRate=function(e){return null==h.video&&(h.video=new Object),h.video.framerate=e,this},this.setVideoStartTime=function(e){return null==h.video&&(h.video=new Object),e=isNaN(e)&&/([0-9]+):([0-9]{2}):([0-9]{2})/.exec(e)?r.durationToSeconds(e):isNaN(e)||parseInt(e)!=e?0:parseInt(e,10),h.video.startTime=e,this},this.setVideoDuration=function(e){return null==h.video&&(h.video=new Object),e=isNaN(e)&&/([0-9]+):([0-9]{2}):([0-9]{2})/.exec(e)?r.durationToSeconds(e):isNaN(e)||parseInt(e)!=e?0:parseInt(e,10),h.video.duration=e,this},this.setVideoAspectRatio=function(e){if(isNaN(e))if(/([0-9]+):([0-9]+)/.exec(e)){var a=/([0-9]+):([0-9]+)/.exec(e);e=parseFloat(a[1]/a[2])}else e=this.metadata.video.aspect.value;return null==h.video&&(h.video=new Object),h.video.aspect=e,this},this.setVideoSize=function(e,a,i,t){return null==h.video&&(h.video=new Object),h.video.size=e,h.video.keepPixelAspectRatio=a,h.video.keepAspectRatio=i,h.video.paddingColor=t,this},this.setAudioCodec=function(e){if(-1!=this.info_configuration.encode.indexOf(e))return"mp3"==e&&-1!=this.info_configuration.modules.indexOf("libmp3lame")&&(e="libmp3lame"),null==h.audio&&(h.audio=new Object),h.audio.codec=e,this;throw t.renderError("codec_not_supported",e)},this.setAudioFrequency=function(e){return null==h.audio&&(h.audio=new Object),h.audio.frequency=e,this},this.setAudioChannels=function(e){if(n.audio_channel.stereo==e||n.audio_channel.mono==e)return null==h.audio&&(h.audio=new Object),h.audio.channel=e,this;throw t.renderError("audio_channel_is_invalid",e)},this.setAudioBitRate=function(e){return null==h.audio&&(h.audio=new Object),h.audio.bitrate=e,this},this.setAudioQuality=function(e){return null==h.audio&&(h.audio=new Object),h.audio.quality=e,this},this.setWatermark=function(a,i){var n={position:"SW",margin_nord:null,margin_sud:null,margin_east:null,margin_west:null};if(!e.existsSync(a))throw t.renderError("invalid_watermark",a);if(null!=i&&r.mergeObject(n,i),null==n.position||!1===r.in_array(n.position,["NE","NC","NW","SE","SC","SW","C","CE","CW"]))throw t.renderError("invalid_watermark_position",n.position);(null==n.margin_nord||isNaN(n.margin_nord))&&(n.margin_nord=0),(null==n.margin_sud||isNaN(n.margin_sud))&&(n.margin_sud=0),(null==n.margin_east||isNaN(n.margin_east))&&(n.margin_east=0),(null==n.margin_west||isNaN(n.margin_west))&&(n.margin_west=0);var o="",s=function(e,a){return(e>0?a?"-":"+":a?"+":"-").toString()+Math.abs(e).toString()},d=function(e,a){return s(e,!1).toString()+s(a,!0).toString()},l=function(e,a){return s(e,!1).toString()+s(a,!0).toString()};switch(n.position){case"NE":o="0"+d(n.margin_east,n.margin_west)+":0"+l(n.margin_nord,n.margin_sud);break;case"NC":o="main_w/2-overlay_w/2"+d(n.margin_east,n.margin_west)+":0"+l(n.margin_nord,n.margin_sud);break;case"NW":o="main_w-overlay_w"+d(n.margin_east,n.margin_west)+":0"+l(n.margin_nord,n.margin_sud);break;case"SE":o="0"+d(n.margin_east,n.margin_west)+":main_h-overlay_h"+l(n.margin_nord,n.margin_sud);break;case"SC":o="main_w/2-overlay_w/2"+d(n.margin_east,n.margin_west)+":main_h-overlay_h"+l(n.margin_nord,n.margin_sud);break;case"SW":o="main_w-overlay_w"+d(n.margin_east,n.margin_west)+":main_h-overlay_h"+l(n.margin_nord,n.margin_sud);break;case"CE":o="0"+d(n.margin_east,n.margin_west)+":main_h/2-overlay_h/2"+l(n.margin_nord,n.margin_sud);break;case"C":o="main_w/2-overlay_w/2"+d(n.margin_east,n.margin_west)+":main_h/2-overlay_h/2"+l(n.margin_nord,n.margin_sud);break;case"CW":o="main_w-overlay_w"+d(n.margin_east,n.margin_west)+":main_h/2-overlay_h/2"+l(n.margin_nord,n.margin_sud)}if(null==arguments[2]||null==arguments[2])return null==h.video&&(h.video=new Object),h.video.watermark={path:a,overlay:o},this;null!=arguments[2]&&!0===arguments[2]&&(this.addInput(a),this.addFilterComplex("overlay="+o))},this.save=function(e,a){if(h.hasOwnProperty("video"))if(h.video.hasOwnProperty("disabled"))this.addCommand("-vn");else if(h.video.hasOwnProperty("format")&&this.addCommand("-f",h.video.format),h.video.hasOwnProperty("codec")&&this.addCommand("-vcodec",h.video.codec),h.video.hasOwnProperty("bitrate")&&this.addCommand("-b",parseInt(h.video.bitrate,10)+"kb"),h.video.hasOwnProperty("framerate")&&this.addCommand("-r",parseInt(h.video.framerate,10)),h.video.hasOwnProperty("startTime")&&this.addCommand("-ss",parseInt(h.video.startTime,10)),h.video.hasOwnProperty("duration")&&this.addCommand("-t",parseInt(h.video.duration,10)),h.video.hasOwnProperty("watermark")&&(this.addInput(h.video.watermark.path),this.addFilterComplex("overlay="+h.video.watermark.overlay)),h.video.hasOwnProperty("size")){var i=v.call(this);null!=i.aspect&&(this.addFilterComplex("scale=iw*sar:ih, pad=max(iw\\,ih*("+i.aspect.x+"/"+i.aspect.y+")):ow/("+i.aspect.x+"/"+i.aspect.y+"):(ow-iw)/2:(oh-ih)/2"+(null!=h.video.paddingColor?":"+h.video.paddingColor:"")),this.addCommand("-aspect",i.aspect.string)),this.addCommand("-s",i.width+"x"+i.height)}return h.hasOwnProperty("audio")&&(h.audio.hasOwnProperty("disabled")?this.addCommand("-an"):(h.audio.hasOwnProperty("codec")&&this.addCommand("-acodec",h.audio.codec),h.audio.hasOwnProperty("frequency")&&this.addCommand("-ar",parseInt(h.audio.frequency)),h.audio.hasOwnProperty("channel")&&this.addCommand("-ac",h.audio.channel),h.audio.hasOwnProperty("quality")&&this.addCommand("-aq",h.audio.quality),h.audio.hasOwnProperty("bitrate")&&this.addCommand("-ab",parseInt(h.audio.bitrate,10)+"k"))),p(e),w.call(this,a)};var f=function(e){m=new Array,u=[e.file_path],c=new Array,_=null,h=new Object},v=function(){var e="boolean"==typeof h.video.keepPixelAspectRatio&&h.video.keepPixelAspectRatio,a="boolean"==typeof h.video.keepAspectRatio&&h.video.keepAspectRatio,i=this.metadata.video.resolution;if(e){if(r.isEmptyObj(this.metadata.video.resolutionSquare))throw t.renderError("resolution_square_not_defined");i=this.metadata.video.resolutionSquare}var n=null,o=null,s=null,d=/([0-9]+)x\?/.exec(h.video.size),l=/\?x([0-9]+)/.exec(h.video.size),m=/([0-9]{1,2})%/.exec(h.video.size),u=/([0-9]+)x([0-9]+)/.exec(h.video.size);if(d)n=parseInt(d[1],10),o=r.isEmptyObj(this.metadata.video.aspect)?Math.round(i.h/(i.w/parseInt(d[1],10))):Math.round(n/this.metadata.video.aspect.x*this.metadata.video.aspect.y);else if(l)o=parseInt(l[1],10),n=r.isEmptyObj(this.metadata.video.aspect)?Math.round(i.w/(i.h/parseInt(l[1],10))):Math.round(o/this.metadata.video.aspect.y*this.metadata.video.aspect.x);else if(m){var c=parseInt(m[1],10)/100;n=Math.round(i.w*c),o=Math.round(i.h*c)}else{if(!u)throw t.renderError("size_format",h.video.size);n=parseInt(u[1],10),o=parseInt(u[2],10)}if(n%2!=0&&(n-=1),o%2!=0&&(o-=1),a){var _=r.gcd(n,o);(s=new Object).x=n/_,s.y=o/_,s.string=s.x+":"+s.y}return{width:n,height:o,aspect:s}},w=function(a,t){var n=null==t,o="function"!=typeof a?i.defer():{promise:null},d=["ffmpeg -i"].concat(u.join(" -i ")).concat(m.join(" ")).concat(c.length>0?['-filter_complex "'].concat(c.join(", ")).join("")+'"':[]).concat([_]);return f(this),r.exec(d,s,function(i,r,s){var l=null;if(!i)if(n)l=d[d.length-1];else for(var m in"/"==t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),l=e.readdirSync(t))l[m]=[t,l[m]].join("/");"function"==typeof a?a(i,l):i?o.reject(i):o.resolve(l)}),o.promise};this.fnExtractSoundToMP3=function(i,t){e.existsSync(i)&&e.unlinkSync(i);var n=a.dirname(i),r=a.basename(i,a.extname(i))+".mp3",o=a.join(n,r);return f(this),this.addCommand("-vn"),this.addCommand("-ar",44100),this.addCommand("-ac",2),this.addCommand("-ab",192),this.addCommand("-f","mp3"),p(o),w.call(this,t)},this.fnExtractFrameToJPG=function(){var e=null,i=null,n=null,o={start_time:null,duration_time:null,frame_rate:null,size:null,number:null,every_n_frames:null,every_n_seconds:null,every_n_percentage:null,keep_pixel_aspect_ratio:!0,keep_aspect_ratio:!0,padding_color:"black",file_name:null};for(var s in arguments)switch(typeof arguments[s]){case"string":e=arguments[s];break;case"object":i=arguments[s];break;case"function":n=arguments[s]}null!==i&&r.mergeObject(o,i),null!=o.start_time&&(/([0-9]+):([0-9]{2}):([0-9]{2})/.exec(o.start_time)?o.start_time=r.durationToSeconds(o.start_time):isNaN(o.start_time)?o.start_time=null:o.start_time=parseInt(o.start_time,10)),null!=o.duration_time&&(/([0-9]+):([0-9]{2}):([0-9]{2})/.exec(o.duration_time)?o.duration_time=r.durationToSeconds(o.duration_time):isNaN(o.duration_time)?o.duration_time=null:o.duration_time=parseInt(o.duration_time,10)),null!=o.frame_rate&&isNaN(o.frame_rate)&&(o.frame_rate=null),null==o.size&&(o.size=this.metadata.video.resolution.w+"x"+this.metadata.video.resolution.h),null!=o.number&&isNaN(o.number)&&(o.number=null);var d=0;if(null!=o.every_n_frames&&isNaN(o.every_n_frames)&&(o.every_n_frames=null,d++),null!=o.every_n_seconds&&isNaN(o.every_n_seconds)&&(o.every_n_seconds=null,d++),null!=o.every_n_percentage&&(isNaN(o.every_n_percentage)||o.every_n_percentage>100)&&(o.every_n_percentage=null,d++),d>=2){if(!n)throw t.renderError("extract_frame_invalid_everyN_options");n(t.renderError("extract_frame_invalid_everyN_options"))}if(null==o.file_name)o.file_name=a.basename(this.file_path,a.extname(this.file_path));else{var l=o.file_name.match(/(\%[a-zA-Z]{1})/g);if(l)for(var s in l)switch(l[s]){case"%t":o.file_name=o.file_name.replace("%t",(new Date).getTime());break;case"%s":o.file_name=o.file_name.replace("%s",o.size);break;case"%x":o.file_name=o.file_name.replace("%x",o.size.split(":")[0]);break;case"%y":o.file_name=o.file_name.replace("%y",o.size.split(":")[1]);break;default:o.file_name=o.file_name.replace(l[s],"")}}o.file_name=a.basename(o.file_name,a.extname(o.file_name))+"_%d.jpg",r.mkdir(e,511),f(this),o.startTime&&this.addCommand("-ss",o.startTime),o.duration_time&&this.addCommand("-t",o.duration_time),o.frame_rate&&this.addCommand("-r",o.frame_rate),this.setVideoSize(o.size,o.keep_pixel_aspect_ratio,o.keep_aspect_ratio,o.padding_color);var m=v.call(this);return this.addCommand("-s",m.width+"x"+m.height),null!=m.aspect&&(this.addFilterComplex("scale=iw*sar:ih, pad=max(iw\\,ih*("+m.aspect.x+"/"+m.aspect.y+")):ow/("+m.aspect.x+"/"+m.aspect.y+"):(ow-iw)/2:(oh-ih)/2"+(null!=o.padding_color?":"+o.padding_color:"")),this.addCommand("-aspect",m.aspect.string)),o.number&&this.addCommand("-vframes",o.number),o.every_n_frames&&(this.addCommand("-vsync",0),this.addFilterComplex("select=not(mod(n\\,"+o.every_n_frames+"))")),o.every_n_seconds&&(this.addCommand("-vsync",0),this.addFilterComplex("select=not(mod(t\\,"+o.every_n_seconds+"))")),o.every_n_percentage&&(this.addCommand("-vsync",0),this.addFilterComplex("select=not(mod(t\\,"+parseInt(this.metadata.duration.seconds/100*o.every_n_percentage)+"))")),p([e,o.file_name].join("/")),w.call(this,n,e)},this.fnAddWatermark=function(e){for(var i=null,t=null,n=null,r=1;r<arguments.length;r++)switch(typeof arguments[r]){case"string":i=arguments[r];break;case"object":t=arguments[r];break;case"function":n=arguments[r]}return f(this),this.setWatermark(e,t,!0),null==i&&(i=a.dirname(this.file_path)+"/"+a.basename(this.file_path,a.extname(this.file_path))+"_watermark_"+a.basename(e,a.extname(e))+a.extname(this.file_path)),p(i),w.call(this,n)};f(this)};
},{"fs":"XGGi","path":"yL0h","when":"JLXO","./errors":"kIfG","./presets":"MiK0","./utils":"X5rs"}],"A0AX":[function(require,module,exports) {
var e=require("when"),r=require("fs"),t=require("./errors"),o=require("./utils"),i=require("./configs"),n=require("./video"),a=function(){var a=function(r,t){var i=[];return i.push(function(r){var t=e.defer(),i={modules:new Array,encode:new Array,decode:new Array};return o.exec(["ffmpeg","-formats","2>&1"],r,function(e,r,o){var n=/configuration:(.*)/.exec(r);if(n){var a=n[1].match(/--enable-([a-zA-Z0-9\-]+)/g);for(var s in a)i.modules.push(/--enable-([a-zA-Z0-9\-]+)/.exec(a[s])[1])}var l=r.match(/ (DE|D|E) (.*) {1,} (.*)/g);for(var c in l){var u=/ (DE|D|E) (.*) {1,} (.*)/.exec(l[c]);if(u){var d=u[1].replace(/\s/g,""),p=u[2].replace(/\s/g,"");"D"!=d&&"DE"!=d||i.decode.push(p),"E"!=d&&"DE"!=d||i.encode.push(p)}}t.resolve(i)}),t.promise}(t)),i.push(function(r,t){var i=e.defer();return o.exec(["ffmpeg","-i",r,"2>&1"],t,function(e,r,t){var n=/from \'(.*)\'/.exec(r)||[],a=/(INAM|title)\s+:\s(.+)/.exec(r)||[],s=/artist\s+:\s(.+)/.exec(r)||[],l=/album\s+:\s(.+)/.exec(r)||[],c=/track\s+:\s(.+)/.exec(r)||[],u=/date\s+:\s(.+)/.exec(r)||[],d=null!==/start: 0.000000/.exec(r),p=/Duration: (([0-9]+):([0-9]{2}):([0-9]{2}).([0-9]+))/.exec(r)||[],v=/Input #0, ([a-zA-Z0-9]+),/.exec(r)||[],f=/bitrate: ([0-9]+) kb\/s/.exec(r)||[],x=/Stream #([0-9\.]+)([a-z0-9\(\)\[\]]*)[:] Video/.exec(r)||[],h=/Video: ([\w]+)/.exec(r)||[],g=/(([0-9]{2,5})x([0-9]{2,5}))/.exec(r)||[],m=/[SP]AR ([0-9\:]+)/.exec(r)||[],w=/DAR ([0-9\:]+)/.exec(r)||[],y=/([0-9\.]+) (fps|tb\(r\))/.exec(r)||[],b=/Stream #([0-9\.]+)([a-z0-9\(\)\[\]]*)[:] Audio/.exec(r)||[],A=/Audio: ([\w]+)/.exec(r)||[],I=/([0-9]+) Hz/i.exec(r)||[],S=/Audio:.* (stereo|mono)/.exec(r)||[],q=/Audio:.* ([0-9]+) kb\/s/.exec(r)||[],E=/rotate[\s]+:[\s]([\d]{2,3})/.exec(r)||[],D={filename:n[1]||"",title:a[2]||"",artist:s[1]||"",album:l[1]||"",track:c[1]||"",date:u[1]||"",synched:d,duration:{raw:p[1]||"",seconds:p[1]?o.durationToSeconds(p[1]):0},video:{container:v[1]||"",bitrate:f.length>1?parseInt(f[1],10):0,stream:x.length>1?parseFloat(x[1]):0,codec:h[1]||"",resolution:{w:g.length>2?parseInt(g[2],10):0,h:g.length>3?parseInt(g[3],10):0},resolutionSquare:{},aspect:{},rotate:E.length>1?parseInt(E[1],10):0,fps:y.length>1?parseFloat(y[1]):0},audio:{codec:A[1]||"",bitrate:q[1]||"",sample_rate:I.length>1?parseInt(I[1],10):0,stream:b.length>1?parseFloat(b[1]):0,channels:{raw:S[1]||"",value:S.length>0?{stereo:2,mono:1}[S[1]]||0:""}}};if(w.length>0){var _=w[1].split(":");D.video.aspect.x=parseInt(_[0],10),D.video.aspect.y=parseInt(_[1],10),D.video.aspect.string=w[1],D.video.aspect.value=parseFloat(D.video.aspect.x/D.video.aspect.y)}else if(D.video.resolution.w>0){var z=o.gcd(D.video.resolution.w,D.video.resolution.h);D.video.aspect.x=D.video.resolution.w/z,D.video.aspect.y=D.video.resolution.h/z,D.video.aspect.string=D.video.aspect.x+":"+D.video.aspect.y,D.video.aspect.value=parseFloat(D.video.aspect.x/D.video.aspect.y)}if(m.length>0){D.video.pixelString=m[1];var F=m[1].split(":");D.video.pixel=parseFloat(parseInt(F[0],10)/parseInt(F[1],10))}else 0!==D.video.resolution.w?(D.video.pixelString="1:1",D.video.pixel=1):(D.video.pixelString="",D.video.pixel=0);1===D.video.pixel&&0===D.video.pixel||(D.video.pixel>1?(D.video.resolutionSquare.w=parseInt(D.video.resolution.w*D.video.pixel,10),D.video.resolutionSquare.h=D.video.resolution.h):(D.video.resolutionSquare.w=D.video.resolution.w,D.video.resolutionSquare.h=parseInt(D.video.resolution.h/D.video.pixel,10))),i.resolve(D)}),i.promise}(r,t)),e.all(i)};return function(s){if(0==s.length||null==s[0])throw t.renderError("empty_input_filepath");if("string"!=typeof s[0])throw t.renderError("input_filepath_must_be_string");var l=s[0];if(!r.existsSync(l))throw t.renderError("fileinput_not_exist");for(var c=new i,u=null,d=1;d<s.length;d++)switch(typeof s[d]){case"object":o.mergeObject(c,s[d]);break;case"function":u=s[d]}var p="function"!=typeof u?e.defer():{promise:null};return e(a(l,c),function(e){"function"==typeof u?u(null,new n(l,c,e[0],e[1])):p.resolve(new n(l,c,e[0],e[1]))},function(e){"function"==typeof u?u(e,null):p.reject(e)}),p.promise}.call(this,arguments)};module.exports=a;
},{"when":"JLXO","fs":"XGGi","./errors":"kIfG","./utils":"X5rs","./configs":"cOiA","./video":"cZQY"}],"WWVp":[function(require,module,exports) {
module.exports=require("./lib/ffmpeg");
},{"./lib/ffmpeg":"A0AX"}],"uybK":[function(require,module,exports) {
"use strict";function t(){this.watermarkPath=null,this.outputFilePath=null,this.settings=null,this.inputVideoPath=null,this.setInputVideoPath=function(t){return this.inputVideoPath=t,this},this.setWatermarkPath=function(t){return this.watermarkPath=t,this},this.getWatermarkpath=function(){return console.log(this.watermarkPath),this.watermarkPath},this.setOutputFilePath=function(t){return this.outputFilePath=t,this},this.setSettings=function(t){return this.settings=t,this},this.convert=function(){var t=require("ffmpeg");console.log("input video path",this.inputVideoPath);try{new t(this.inputVideoPath,function(t,e){t?console.log("Error: "+t):console.log("The video is ready to be processed")})}catch(e){console.log(e.code),console.log(e.msg)}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.WaterMark=t;
},{"ffmpeg":"WWVp"}],"Focm":[function(require,module,exports) {
"use strict";var e=o(require("./MediaStreamRecorder.min.js")),t=require("./watermark.js");function o(e){return e&&e.__esModule?e:{default:e}}var n,a,r=new t.WaterMark,i="https://archive.org/download/ffmpeg_asm/ffmpeg_asm.js",s=null,c=document.querySelector(".inner"),d=document.querySelector("button#record"),u=document.querySelector("button#stop");function l(e,t,o){navigator.mediaDevices.getUserMedia(e).then(t).catch(o)}var p={audio:!0,video:!0};function m(){var e=URL.createObjectURL(new Blob(['importScripts("'+i+'");var now = Date.now;function print(text) {postMessage({"type" : "stdout","data" : text});};onmessage = function(event) {var message = event.data;if (message.type === "command") {var Module = {print: print,printErr: print,files: message.files || [],arguments: message.arguments || [],TOTAL_MEMORY: message.TOTAL_MEMORY || false};postMessage({"type" : "start","data" : Module.arguments.join(" ")});postMessage({"type" : "stdout","data" : "Received command: " +Module.arguments.join(" ") +((Module.TOTAL_MEMORY) ? ".  Processing with " + Module.TOTAL_MEMORY + " bits." : "")});var time = now();var result = ffmpeg_run(Module);var totalTime = now() - time;postMessage({"type" : "stdout","data" : "Finished processing (took " + totalTime + "ms)"});postMessage({"type" : "done","data" : result,"time" : totalTime});}};postMessage({"type" : "ready"});'],{type:"application/javascript"})),t=new Worker(e);return URL.revokeObjectURL(e),t}function g(e,t,o){var a,r=new FileReader;r.onload=function(){a=this.result,i()},r.readAsArrayBuffer(e),n||(n=m()),n.onmessage=function(n){var a=n.data;if("ready"==a.type)!0;else if("stdout"==a.type);else if("start"==a.type);else if("done"==a.type){console.log(JSON.stringify(a));var r=new File([e],t.uuid+".mp4",{type:"video/mp4"});o(r)}};var i=function(){!0,n.postMessage({type:"command",arguments:"-i ".concat(t.inputVideoFilePath," -i ").concat(t.inputLogoFilePath,'  -filter_complex "overlay=x=main_w*0.01:y=main_h*0.01"  ').concat(t.outputFilePath).split(" "),files:[{data:new Uint8Array(a),name:"".concat(t.uuid,".webm")}]})}}function f(e){var t=Date.now(),o=new File([e],t+".mp4",{type:"video/mp4"});j(o,o.name,function(e){new(require("ffmpeg"))(e.inputVideoFilePath,function(e,t){e?console.log("Error: "+e):console.log("The video is ready to be processed")})})}function v(t){d.disabled=!1,console.log("getUserMedia() got stream:",t),window.stream=t,document.querySelector("video#gum").srcObject=t,(a=new e.default(t)).mimeType="video/webm",a.stream=t;a.ondataavailable=f,a.start(5e3)}function y(e){console.error("media error",e)}var M=document.getElementById("videos-container"),w=1;function h(e){if(0===e)return"0 Bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return(e/Math.pow(1e3,t)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][t]}function T(e){var t=new Date(e);return t.getUTCHours()+" hours, "+t.getUTCMinutes()+" minutes and "+t.getUTCSeconds()+" second(s)"}function b(){$("video#recorded").trigger("click")}function R(){$("#stop-recording").trigger("click")}function S(){a.stop()}function O(e,t){return Math.floor(Math.random()*(t-e+1))+e}window.onbeforeunload=function(){document.querySelector("button#record").disabled=!1,b()};var _=O(1,1e3);function j(e,t,o){var n=new FormData;n.append("files",e),n.append("filename",t),n.append("customer_id",_),$.ajax({type:"POST",url:"http://localhost/webm-tomp4/save.php",data:n,processData:!1,contentType:!1,success:o})}d.addEventListener("click",function(){"Start Recording"===d.textContent?(d.textContent="Stop Recording",console.log("Start Recording"),l(p,v,y)):(S(),console.log("Stop Recording"),d.textContent="Start Recording")});
},{"./MediaStreamRecorder.min.js":"mhoU","./watermark.js":"uybK","ffmpeg":"WWVp"}]},{},["Focm"], null)
//# sourceMappingURL=/webm-tomp4.243f4353.js.map